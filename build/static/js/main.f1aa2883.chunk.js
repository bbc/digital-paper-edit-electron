(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{103:function(e,t,a){"use strict";(function(e,a){function n(){if(void 0===window.process)return"browser";if(void 0!==window.process.versions.electron)return"electron";if(void 0!==window.process.versions.cep){try{e.chdir(a)}catch(t){console.log("chdir: "+t)}return"cep"}console.error("couldn't determine the js environment")}t.a=n}).call(this,a(113),"/")},143:function(e,t,a){e.exports={speaker:"generate-paragraphs_speaker__2DC8z",unselectable:"generate-paragraphs_unselectable__1wCnj",highlightedWord:"generate-paragraphs_highlightedWord__3YCEc"}},145:function(e,t,a){e.exports={speaker:"Paragraphs_speaker__1kdz6",unselectable:"Paragraphs_unselectable__3k2Ob",highlightedWord:"Paragraphs_highlightedWord__3mJtY"}},224:function(e,t,a){e.exports=a.p+"static/media/labsLogo.658ac9e3.png"},241:function(e,t,a){e.exports=a(489)},246:function(e,t,a){},291:function(e,t,a){},474:function(e,t,a){},488:function(e,t,a){},489:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(31),o=a.n(s),l=(a(246),a(5)),i=a(6),c=a(8),d=a(7),p=a(9),h=a(148),u=a(222),m=a(100),f=(a(247),a(11)),b=a.n(f),g=a(18),E=a(42),v=a(51),S=a(36),w=a.n(S),k=a(13),y=a.n(k),j=a(4),x=a.n(j),O=a(80),C=a.n(O),P=a(57),I=a(3),T=a(2);var L=function(){return r.a.createElement(C.a,{collapseOnSelect:!0,expand:"md",bg:"light",variant:"light",fixed:"top"},r.a.createElement(P.LinkContainer,{to:"/projects"},r.a.createElement(C.a.Brand,null,r.a.createElement(I.a,{icon:T.n}),"  ","")))},N=a(23),D=a.n(N),A=a(15),M=a.n(A),F=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleDelete=function(){!0===confirm("Click OK if you wish to delete, cancel if you don't")?a.props.handleDelete&&a.props.handleDelete(a.props.id):alert("All is good, it was not deleted")},a.handleEdit=function(){a.props.handleEdit(a.props.id)},a.showLinkPath=function(){return a.props.showLinkPath(a.props.id)},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(D.a,{style:{width:"100%",marginBottom:"1em"}},r.a.createElement(D.a.Body,null,r.a.createElement(y.a,null,r.a.createElement(P.LinkContainer,{to:this.showLinkPath(),style:{cursor:"pointer"}},r.a.createElement(x.a,{xs:8,sm:10,md:10,ld:10,xl:10},r.a.createElement(D.a.Title,null,r.a.createElement("a",{href:"#".concat(this.showLinkPath())},this.props.title)))),r.a.createElement(x.a,{xs:2,sm:1,md:1,ld:1,xl:1},r.a.createElement(D.a.Link,null,r.a.createElement(M.a,{onClick:this.handleEdit,variant:"outline-secondary",size:"sm"},r.a.createElement(I.a,{icon:T.w})))),r.a.createElement(x.a,{xs:2,sm:1,md:1,ld:1,xl:1},r.a.createElement(D.a.Link,null,r.a.createElement(M.a,{onClick:this.handleDelete,variant:"outline-secondary",size:"sm"},r.a.createElement(I.a,{icon:T.K}))))),r.a.createElement(P.LinkContainer,{to:this.showLinkPath(),style:{cursor:"pointer"}},r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(D.a.Subtitle,{className:"mb-2 text-muted"},this.props.description))))))}}]),t}(n.Component),U=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.items.map(function(t){return t.display?r.a.createElement(F,{key:t.id,id:t.id,title:t.title,description:t.description,handleEdit:e.props.handleEdit,handleDelete:e.props.handleDelete,showLinkPath:e.props.showLinkPath}):null}).filter(function(e){return null!==e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{style:{height:"75vh",overflow:"scroll"}},t))}}]),t}(r.a.Component),B=function(e,t){return e.toLowerCase().trim().includes(t.toLowerCase().trim())},R=a(30),_=a.n(R),W=a(56),J=a.n(W),G=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleSearch=function(e){var t=e.target.value;a.props.handleSearch(t)},a.handleShowSearchBar=function(){a.setState(function(e){return{showSearchInput:!e.showSearchInput}})},a.state={showSearchInput:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(_.a,{className:"mb-3"},r.a.createElement(_.a.Prepend,{onClick:this.handleShowSearchBar},r.a.createElement(_.a.Text,{id:"basic-addon2"},r.a.createElement(I.a,{icon:T.A}))),r.a.createElement(J.a,{style:{display:this.state.showSearchInput?"":"none"},onChange:this.handleSearch,placeholder:"Search","aria-label":"search","aria-describedby":"search"}))}}]),t}(r.a.Component),V=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleSearch=function(e){var t=a.props.items.filter(function(t){return B(t.title,e)||B(t.description,e)?(t.display=!0,t):(t.display=!1,t)});a.props.handleUpdateList(t)},a.handleShowSearchBar=function(){a.setState(function(e){return{showSearchInput:!e.showSearchInput}})},a.state={showSearchInput:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e;return null!==this.props.items&&0!==this.props.items.length&&(e=r.a.createElement(G,{handleSearch:this.handleSearch})),r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:9,md:9,ld:9,xl:9},e),r.a.createElement(x.a,{xs:12,sm:3,md:3,ld:3,xl:3},r.a.createElement(M.a,{onClick:this.props.handleShowCreateNewItemForm,variant:"outline-secondary",size:"sm",block:!0},"New ",this.props.model))),this.props.items&&0===this.props.items.length?r.a.createElement("i",null,"There are no ",this.props.model,", create a new one to get started"):null,this.props.items?r.a.createElement(U,{items:this.props.items,handleEdit:this.props.handleEdit,handleDelete:this.props.handleDelete,showLinkPath:this.props.showLinkPath}):null)}}]),t}(r.a.Component),q=a(28),z=a.n(q),K=a(12),H=a.n(K),X=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleTitleChange=function(e){a.setState({title:e.target.value})},a.handleDescriptionChange=function(e){a.setState({description:e.target.value})},a.state={title:a.props.title,description:a.props.description,validated:!1,id:a.props.id},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleSubmit",value:function(e){var t=e.currentTarget;if(t.checkValidity()||(e.preventDefault(),e.stopPropagation(),this.setState({validated:!0})),t.checkValidity()){e.preventDefault(),e.stopPropagation();var a={title:this.state.title,description:this.state.description,id:this.state.id};this.props.handleSaveForm(a)}}},{key:"render",value:function(){var e=this;return r.a.createElement(H.a,{noValidate:!0,validated:this.state.validated,onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(H.a.Group,{controlId:"formBasicEmail"},r.a.createElement(H.a.Label,null,"Title "),r.a.createElement(H.a.Control,{required:!0,type:"text",placeholder:"Enter a project title",value:this.state.title,onChange:this.handleTitleChange}),r.a.createElement(H.a.Text,{className:"text-muted"},"Chose a title"),r.a.createElement(H.a.Control.Feedback,null,"Looks good!"),r.a.createElement(H.a.Control.Feedback,{type:"invalid"},"Please chose a title")),r.a.createElement(H.a.Group,{controlId:"formBasicEmail"},r.a.createElement(H.a.Label,null,"Description "),r.a.createElement(H.a.Control,{type:"text",placeholder:"Enter a project description",value:this.state.description,onChange:this.handleDescriptionChange}),r.a.createElement(H.a.Text,{className:"text-muted"},"Chose an optional description"),r.a.createElement(H.a.Control.Feedback,null,"Looks good!"),r.a.createElement(H.a.Control.Feedback,{type:"invalid"},"Please chose a description")),r.a.createElement(z.a.Footer,null,r.a.createElement(M.a,{variant:"primary",type:"submit"},"Save")))}}]),t}(n.Component),Y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleClose=function(){a.props.handleCloseModal()},a.state={title:"title"},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(z.a,{show:this.props.show,onHide:this.handleClose},r.a.createElement(z.a.Header,{closeButton:!0},r.a.createElement(z.a.Title,null,this.props.modalTitle)),r.a.createElement(z.a.Body,null,r.a.createElement(X,{title:this.props.title,description:this.props.description,id:this.props.id,handleSaveForm:this.props.handleSaveForm})))}}]),t}(r.a.Component),$=a(108),Q=a.n($),Z=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.items.map(function(e,t){return e.link?r.a.createElement(P.LinkContainer,{key:t,to:e.link},r.a.createElement(Q.a.Item,null,e.name)):r.a.createElement(Q.a.Item,{key:t,active:!0},e.name)});return r.a.createElement("div",null,r.a.createElement(Q.a,null,e))}}]),t}(n.Component),ee=a(224),te=a.n(ee);var ae=function(){var e=r.a.createElement(C.a,{collapseOnSelect:!0,expand:"md",bg:"light",variant:"light",fixed:"bottom",className:"justify-content-center"},r.a.createElement("small",null,r.a.createElement("img",{src:te.a,style:{height:"2em"},alt:"Labs Logo"})," This is a prototype from"," ",r.a.createElement("a",{href:"http://bbcnewslabs.co.uk/",target:"_blank",rel:"noopener noreferrer"},"BBC News Labs")));return r.a.createElement(y.a,null,r.a.createElement(x.a,{className:"d-none d-sm-block"},e),r.a.createElement(x.a,{className:"d-lg-block d-md-block"},e))},ne=a(225),re=a.n(ne),se=["GET","POST","PUT","DELETE"],oe=function(e){if(!se.includes(e))throw new Error("Wrong method passed ".concat(e," - should be one of ").concat(se))},le=function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"PUT"===e?t={method:e,mode:"cors",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}:"POST"===e?(t={method:e},"json"===n?(t.headers={"Content-Type":"application/json"},t.body=JSON.stringify(a)):t.body=a):t={method:e,mode:"cors"},t};function ie(){return(ie=Object(g.a)(b.a.mark(function e(t){var a,n,r,s,o=arguments;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:"GET",n=o.length>2&&void 0!==o[2]?o[2]:{},r=o.length>3?o[3]:void 0,oe(a),s=le(a,n,r),e.next=7,fetch(t,s);case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ce=function(e){return ie.apply(this,arguments)},de=function(){function e(){var t=this;Object(l.a)(this,e),this.projectsIdUrl=function(e){return"".concat(t.projectsUrl,"/").concat(e)},this.transcriptsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/transcripts")},this.transcriptsIdUrl=function(e,a,n){var r=n?"?".concat(re.a.stringify(n)):"";return"".concat(t.transcriptsUrl(e),"/").concat(a).concat(r).trim()},this.paperEditsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/paperedits")},this.paperEditsIdUrl=function(e,a){return"".concat(t.projectsIdUrl(e),"/paperedits/").concat(a)},this.annotationsUrl=function(e,a){return"".concat(t.transcriptsIdUrl(e,a),"/annotations")},this.annotationsIdUrl=function(e,a,n){return"".concat(t.transcriptsIdUrl(e,a),"/annotations/").concat(n)},this.labelsUrl=function(e){return"".concat(t.projectsIdUrl(e),"/labels")},this.labelsIdUrl=function(e,a){return"".concat(t.projectsIdUrl(e),"/labels/").concat(a)},this.baseUrl=window.env.API_URL,window.env.API_URL=null,this.projectsUrl="".concat(this.baseUrl,"/api/projects")}return Object(i.a)(e,[{key:"getAllProjects",value:function(){var e=Object(g.a)(b.a.mark(function e(){var t,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.projectsUrl);case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.abrupt("return",a.projects);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getProject",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.projectsIdUrl(t));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createProject",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.projectsUrl,"POST",t,"json");case 2:return a=e.sent,e.next=5,a.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateProject",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.projectsIdUrl(t),"PUT",a);case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"deleteProject",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.projectsIdUrl(t),"DELETE");case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTranscripts",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.transcriptsUrl(t));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"createTranscript",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.transcriptsUrl(t),"POST",a);case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getTranscript",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a,n){var r,s,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.transcriptsIdUrl(t,a,n));case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,e.next=8,this.getProject(t);case 8:return o=e.sent,s.projectTitle=o.project.title,s.transcriptTitle=s.title,delete s.title,e.abrupt("return",s);case 13:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"updateTranscript",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a,n,r){var s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.transcriptsIdUrl(t,a,n),"PUT",r);case 2:return s=e.sent,e.abrupt("return",s);case 4:case"end":return e.stop()}},e,this)}));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"deleteTranscript",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.transcriptsIdUrl(t,a),"DELETE");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getAllAnnotations",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.annotationsUrl(t,a));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getAnnotation",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a,n){var r,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.annotationsIdUrl(t,a,n));case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"createAnnotation",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a,n){var r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.annotationsUrl(t,a),"POST",n,"json");case 2:return r=e.sent,e.next=5,r.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"updateAnnotation",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a,n,r){var s,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.annotationsIdUrl(t,a,n),"PUT",r);case 2:return s=e.sent,e.next=5,s.json();case 5:return o=e.sent,e.abrupt("return",o);case 7:case"end":return e.stop()}},e,this)}));return function(t,a,n,r){return e.apply(this,arguments)}}()},{key:"deleteAnnotation",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a,n){var r,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.annotationsIdUrl(t,a,n),"DELETE");case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"getAllLabels",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.labelsUrl(t));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getLabel",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.labelsIdUrl(t,a));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"createLabel",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.labelsUrl(t),"POST",a,"json");case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"updateLabel",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a,n){var r,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.labelsIdUrl(t,a),"PUT",n);case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"deleteLabel",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.labelsIdUrl(t,a),"DELETE");case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"getAllPaperEdits",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.paperEditsUrl(t));case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n.paperedits);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPaperEdit",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.paperEditsIdUrl(t,a));case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"createPaperEdit",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.paperEditsUrl(t),"POST",a,"json");case 2:return n=e.sent,e.next=5,n.json();case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"updatePaperEdit",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a,n){var r,s;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.paperEditsIdUrl(t,a),"PUT",n);case 2:return r=e.sent,e.next=5,r.json();case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t,a,n){return e.apply(this,arguments)}}()},{key:"deletePaperEdit",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ce(this.paperEditsIdUrl(t,a),"DELETE");case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"get_TranscriptLabelsAnnotations",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r,s,o;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTranscript(t,a);case 2:return n=e.sent,e.next=5,this.getAllLabels(t,a);case 5:return r=e.sent,e.next=8,this.getAllAnnotations(t,a);case 8:return s=e.sent,o={transcriptId:a,projectId:t,projectTitle:n.projectTitle,transcriptTitle:n.transcriptTitle,url:n.url,labels:r.labels,transcript:n.transcript,annotations:s.annotations},e.abrupt("return",o);case 11:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"get_ProgrammeScriptAndTranscripts",value:function(){var e=Object(g.a)(b.a.mark(function e(t,a){var n,r,s,o,l,i,c,d=this;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTranscripts(t);case 2:return n=e.sent,e.next=5,Promise.all(n.transcripts.map(function(e){return d.getTranscript(t,e.id)}));case 5:return r=e.sent,e.next=8,Promise.all(n.transcripts.map(function(e){return d.getAllAnnotations(t,e.id)}));case 8:return s=e.sent,r.forEach(function(e){var t=s.find(function(t){return t.transcriptId===e.id});e.annotations=t?t.annotations:[]}),e.next=12,this.getPaperEdit(t,a);case 12:return o=e.sent,e.next=15,this.getProject(t);case 15:return l=e.sent,e.next=18,this.getAllLabels(t);case 18:return i=e.sent,c={programmeScript:o.programmeScript,project:l.project,transcripts:r,labels:i.labels},e.abrupt("return",c);case 21:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),e}(),pe=a(103),he=Object(pe.a)(),ue=function(){if("browser"===he){var e=new de;return Object.freeze(e),e}if("electron"===he){var t=new(0,window.ElectronWrapper);return Object.freeze(t),t}}(),me=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleSaveItem=function(e){e.id?ue.updateProject(e.id,e).then(function(t){if("ok"===t.status){var n=t.project;n.display=!0;var r=a.state.items;a.findItemById(r,e),r[a.state.items.findIndex(function(e){return e.id===n.id})]=n,a.setState({isNewItemModalShow:!1,items:r,title:"",itemId:null,description:""})}}):ue.createProject(e).then(function(e){if("ok"===e.status){var t=Object(E.a)(a.state.items);e.project.display=!0,t.push(e.project),a.setState({isNewItemModalShow:!1,items:t,title:"",itemId:null,description:""})}})},a.findItemById=function(e,t){return e.filter(function(e){return e.id===t})[0]},a.handleEditItem=function(e){var t=a.findItemById(a.state.items,e);a.setState({title:t.title,itemId:t.id,description:t.description,isNewItemModalShow:!0}),console.log("edit item",t)},a.showLinkPathToItem=function(e){return"/projects/".concat(e)},a.handleUpdateList=function(e){a.setState({items:e})},a.handleShowCreateNewItemForm=function(){a.setState({isNewItemModalShow:!0})},a.handleCloseModal=function(){a.setState({title:"",itemId:null,description:"",isNewItemModalShow:!1})},a.state={items:[],isNewItemModalShow:!1,title:"",description:"",itemId:null},a.handleDeleteItem=a.handleDeleteItem.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(g.a)(b.a.mark(function e(){var t,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ue.getAllProjects();case 3:(t=e.sent)&&(a=t.map(function(e){return e.display=!0,e}),this.setState({items:a})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("Error with ApiWrapper.getAllProjects",e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(){return e.apply(this,arguments)}}()},{key:"handleDeleteItem",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.deleteProject(t);case 2:e.sent.ok&&(a=this.state.items.filter(function(e){return e.id!==t}),this.setState({items:a}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,null),r.a.createElement(w.a,{style:{marginBottom:"5em",marginTop:"1em"}},r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:12,md:12,ld:12,xl:12},r.a.createElement(Z,{items:[{name:"Projects"}]}))),r.a.createElement(V,{model:"Project",items:this.state.items,handleShowCreateNewItemForm:this.handleShowCreateNewItemForm,deleteItem:this.createNew,editItem:this.createNew,handleEdit:this.handleEditItem,handleDelete:this.handleDeleteItem,showLinkPath:this.showLinkPathToItem,handleUpdateList:this.handleUpdateList}),r.a.createElement(Y,{title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:this.state.itemId?"Edit Project":"New Project",show:this.state.isNewItemModalShow,handleCloseModal:this.handleCloseModal,handleSaveForm:this.handleSaveItem})),r.a.createElement(ae,null))}}]),t}(r.a.Component),fe=a(227),be=a.n(fe),ge=a(48),Ee=a.n(ge),ve=a(109),Se=a.n(ve),we=a(58),ke=a.n(we),ye=a(226),je=a.n(ye),xe=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleDelete=function(){!0===confirm("Click OK if you wish to delete, cancel if you don't")?a.props.handleDelete&&a.props.handleDelete(a.props.id):alert("All is good, it was not deleted")},a.handleEdit=function(){a.props.handleEdit(a.props.id)},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t,a;"error"===this.props.status&&(e="danger"),"in-progress"===this.props.status&&(e="info",t=r.a.createElement(Se.a,{variant:"info"},"In progress")),"done"===this.props.status&&(t=r.a.createElement(Se.a,{variant:"success"},"Success"),e="success");var n=r.a.createElement("a",{href:"#".concat(this.props.showLink())}," ",this.props.title);return e&&"info"===e&&(n=this.props.title),e&&"danger"===e&&(n=this.props.title,a="danger"),"error"===this.props.status&&(t=r.a.createElement(r.a.Fragment,null,r.a.createElement(ke.a,{variant:"danger"},r.a.createElement(I.a,{icon:T.j})," ",this.props.errorMessage),r.a.createElement(Se.a,{variant:"danger"},"Error"))),r.a.createElement(D.a,{border:a,style:{width:"100%",marginBottom:"2em"}},r.a.createElement(D.a.Body,null,r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:9,md:9,ld:9,xl:9},r.a.createElement(D.a.Title,null,this.props.icon?this.props.icon:""," ",n)),r.a.createElement(x.a,{xs:2,sm:1,md:1,ld:1,xl:1},r.a.createElement(D.a.Link,null,r.a.createElement(M.a,{onClick:this.handleEdit,variant:"outline-secondary",size:"sm"},r.a.createElement(I.a,{icon:T.w})))),r.a.createElement(x.a,{xs:2,sm:1,md:1,ld:1,xl:1},r.a.createElement(D.a.Link,null,r.a.createElement(M.a,{onClick:this.handleDelete,variant:"outline-secondary",size:"sm"},r.a.createElement(I.a,{icon:T.K})))),r.a.createElement(x.a,{xs:1,sm:1,md:1,ld:1,xl:1},e&&"info"===e?r.a.createElement(M.a,{variant:"info",size:"sm",disabled:!0},r.a.createElement(je.a,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})):"",e&&"danger"===e?r.a.createElement(M.a,{variant:"danger",size:"sm",disabled:!0},r.a.createElement(I.a,{icon:T.j})):"",e&&"success"===e?r.a.createElement(M.a,{variant:"success",size:"sm",disabled:!0},r.a.createElement(I.a,{icon:T.f})):"")),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:12,md:12,ld:12,xl:12},r.a.createElement(D.a.Subtitle,{className:"mb-2 text-muted"},this.props.subtitle))),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:12,md:12,ld:12,xl:12},t))))}}]),t}(n.Component),Oe=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleSearch=function(e){var t=a.props.items.filter(function(t){return B(t.title,e)||B(t.description,e)?(t.display=!0,t):(t.display=!1,t)});a.props.handleUpdateList(t)},a.state={showSearchInput:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t,a,n=this;return this.props.items&&(e=this.props.items.map(function(e){return e.display?r.a.createElement(xe,{icon:n.props.icon,key:"key__"+e.id,id:e.id,projectId:e.id,title:e.title,subtitle:e.description,handleEdit:n.props.handleEdit,handleDelete:function(){n.props.handleDelete(e.id)},showLink:function(){return n.props.showLinkPath(e.id)},status:e.status,description:void 0,disabled:"done"===e.status,errorMessage:"error"===e.status?e.errorMessage:null}):null}).filter(function(e){return null!==e})),null!==this.props.items&&0!==this.props.items.length&&(a=r.a.createElement(G,{handleSearch:this.handleSearch})),t=null!==this.props.items&&0!==this.props.items.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("section",{style:{height:"75vh",overflow:"scroll"}},e)):r.a.createElement("i",null,"No ",this.props.model,", create a new one to get started "),r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:9,md:9,ld:9,xl:9},a),r.a.createElement(x.a,{xs:12,sm:3,md:3,ld:3,xl:3},r.a.createElement(M.a,{onClick:this.props.handleShowCreateNewItemForm,variant:"outline-secondary",size:"sm",block:!0},"New ",this.props.model))),t)}}]),t}(n.Component),Ce=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleDismiss=function(){return a.setState({show:!1})},a.state={show:!0},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.state.show?r.a.createElement(ke.a,{variant:this.props.variant,onClose:this.handleDismiss,dismissible:!0},this.props.heading?r.a.createElement(ke.a.Heading,null,this.props.heading):"",this.props.message):r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null))}}]),t}(r.a.Component),Pe=(a(291),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleTitleChange=function(e){a.setState({title:e.target.value})},a.handleDescriptionChange=function(e){a.setState({description:e.target.value})},a.handleFileUpload=function(e){var t=Array.from(e.target.files)[0],n=new FormData;n.append("file",t),n.append("type",t.type),t.path&&n.append("path",t.path),a.setState({mediaFileSelected:!0,formData:n}),""===a.state.title&&a.setState({title:t.name})},a.sendRequest=function(){a.setState({uploading:!0});var e=a.state.formData;e.append("title",a.state.title),e.append("description",a.state.description),console.log("formData.get('path')",e.get("path"));var t={};"electron"===Object(pe.a)()&&(t={title:e.get("title"),description:e.get("description"),path:e.get("path")});try{ue.createTranscript(a.state.projectId,a.state.formData,t).then(function(e){console.log("ApiWrapper.createTranscript-response ",e),a.setState({uploading:!1,uploadCompleted:!0,redirect:!0,newTranscriptId:e.transcriptId}),a.props.handleSaveForm(e.transcript)}).catch(function(e){console.log("error:::: ",e),a.setState({uploading:!1,redirect:!1,savedNotification:r.a.createElement(Ce,{dismissable:!0,variant:"danger",heading:"Error could not contact the server",message:r.a.createElement("p",null,"There was an error trying to create this transcript on the server")})})})}catch(n){console.error("error submitting:::",n)}},a.state={projectId:a.props.projectId,validated:!1,redirect:!1,newTranscriptId:null,uploading:!1,uploadCompleted:!1,mediaFileSelected:!1,title:a.props.title,description:a.props.description,id:a.props.id,formData:null,savedNotification:null},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"handleSubmit",value:function(e){var t=e.currentTarget;console.log("(form.checkValidity()",t.checkValidity()),t.checkValidity()||(e.preventDefault(),e.stopPropagation(),this.setState({validated:!0})),t.checkValidity()&&(e.preventDefault(),e.stopPropagation(),this.sendRequest())}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.savedNotification,r.a.createElement(H.a,{noValidate:!0,validated:this.state.validated,onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement(H.a.Group,{controlId:"formTranscriptTitle"},r.a.createElement(H.a.Label,null,"Title "),r.a.createElement(H.a.Control,{required:!0,type:"text",placeholder:"Enter a transcript title",value:this.state.title,onChange:this.handleTitleChange}),r.a.createElement(H.a.Text,{className:"text-muted"},"Chose a title for your Transcript"),r.a.createElement(H.a.Control.Feedback,null,"Looks good!"),r.a.createElement(H.a.Control.Feedback,{type:"invalid"},"Please chose a title for your transcript")),r.a.createElement(H.a.Group,{controlId:"formTranscriptDescription"},r.a.createElement(H.a.Label,null,"Description "),r.a.createElement(H.a.Control,{type:"text",placeholder:"Enter a Transcript description",value:this.state.description,onChange:this.handleDescriptionChange}),r.a.createElement(H.a.Text,{className:"text-muted"},"Chose an optional description for your Transcript"),r.a.createElement(H.a.Control.Feedback,null,"Looks good!"),r.a.createElement(H.a.Control.Feedback,{type:"invalid"},"Please chose a description for your transcript")),r.a.createElement(H.a.Group,{controlId:"formTranscriptMediaFile"},r.a.createElement(H.a.Control,{required:!0,type:"file",label:"Upload",accept:"audio/*,video/*",onChange:this.handleFileUpload}),r.a.createElement(H.a.Text,{className:"text-muted"},"Select an audio or video file to upload"),r.a.createElement(H.a.Control.Feedback,null,"Looks good!"),r.a.createElement(H.a.Control.Feedback,{type:"invalid"},"Please chose a audio or video file to upload")),r.a.createElement(z.a.Footer,null,r.a.createElement(M.a,{variant:"primary",type:"submit"},"Save"))))}}]),t}(n.Component)),Ie=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleClose=function(){a.props.handleCloseModal()},a.state={title:"title"},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(z.a,{show:this.props.show,onHide:this.handleClose},r.a.createElement(z.a.Header,{closeButton:!0},r.a.createElement(z.a.Title,null,this.props.modalTitle)),r.a.createElement(z.a.Body,null,r.a.createElement(Pe,{projectId:this.props.projectId,title:this.props.title,description:this.props.description,id:this.props.id,handleSaveForm:this.props.handleSaveForm,handleCloseModal:this.props.handleCloseModal})))}}]),t}(r.a.Component),Te=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleSaveItem=function(e){console.log("handleSaveItem",e);var t=e;t.display=!0;var n=a.state.items,r=Object(E.a)(n);r.push(t),a.setState({items:r,title:"",itemId:null,description:"",isNewItemModalShow:!1},function(e,t){console.log("setState",e,t)})},a.handleSaveEditedItem=function(e){var t=e;console.log("newEditedITem",t),t.display=!0;var n=a.state.items,r=n.findIndex(function(t){return t.id===e.id}),s=Object(E.a)(n);e.status=s[r].status,s[r]=e;var o=t.id;ue.updateTranscript(a.state.projectId,o,!1,t).then(function(e){e.ok&&(console.log("ApiWrapper.updateTranscript",e,s),a.setState({items:s,isEditItemModalShow:!1}))})},a.findItemById=function(e,t){return e.filter(function(e){return e.id===t})[0]},a.handleEditItem=function(e){var t=a.findItemById(a.state.items,e);a.setState({title:t.title,itemId:t.id,description:t.description,isEditItemModalShow:!0})},a.showLinkPathToItem=function(e){return"/projects/".concat(a.state.projectId,"/transcripts/").concat(e,"/correct")},a.handleUpdateList=function(e){a.setState({items:e})},a.handleShowCreateNewItemForm=function(){a.setState({isNewItemModalShow:!0})},a.handleCloseModal=function(){a.setState({title:"",itemId:null,description:"",isNewItemModalShow:!1})},a.handleCloseModalEdit=function(){a.setState({title:"",itemId:null,description:"",isEditItemModalShow:!1})},a.handleUpdateList=function(e){a.setState({items:e,isNewItemModalShow:!1})},a.state={projectId:a.props.projectId,items:[],isNewItemModalShow:!1,title:"",description:"",itemId:null,projectTitle:"",isServerError:!1,isEditItemModalShow:!1},a.handleDelete=a.handleDelete.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(g.a)(b.a.mark(function e(){var t,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.getTranscripts(this.state.projectId);case 2:(t=e.sent)&&(a=t.transcripts.map(function(e){return e.display=!0,e}),this.setState({projectTitle:t.projectTitle,items:a}));case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleDelete",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a,n,r;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.deleteTranscript(this.state.projectId,t);case 2:a=e.sent,n=function(e){return e.id!==t},a.ok&&(r=this.state.items.filter(function(e){return n(e)}),this.setState({items:r}));case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{marginBottom:"5em",marginTop:"1em"}},r.a.createElement(Oe,{model:"Transcript",items:this.state.items,handleShowCreateNewItemForm:this.handleShowCreateNewItemForm,handleEdit:this.handleEditItem,handleDelete:this.handleDelete,showLinkPath:this.showLinkPathToItem,handleUpdateList:this.handleUpdateList,handleCloseModal:this.handleCloseModal,icon:r.a.createElement(I.a,{icon:T.l})}),r.a.createElement(Ie,{projectId:this.state.projectId,title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:"New Transcript",show:this.state.isNewItemModalShow,handleCloseModal:this.handleCloseModal,handleSaveForm:this.handleSaveItem}),r.a.createElement(Y,{title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:"Edit Transcript",show:this.state.isEditItemModalShow,handleCloseModal:this.handleCloseModalEdit,handleSaveForm:this.handleSaveEditedItem})))}}]),t}(n.Component),Le=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleSaveItem=function(e){e.id?ue.updatePaperEdit(a.state.projectId,e.id,e).then(function(t){if("ok"===t.status){var n=t.paperedit;n.display=!0;var r=a.state.items,s=Object(E.a)(r);a.findItemById(r,e),s[r.findIndex(function(e){return e.id===n.id})]=n,a.setState({isNewItemModalShow:!1,items:s,title:"",itemId:null,description:""})}}):ue.createPaperEdit(a.state.projectId,e).then(function(e){if("ok"===e.status){var t=Object(E.a)(a.state.items);e.paperedit.display=!0,t.push(e.paperedit),a.setState({isNewItemModalShow:!1,items:t,title:"",itemId:null,description:""})}})},a.findItemById=function(e,t){return e.filter(function(e){return e.id===t})[0]},a.handleEditItem=function(e){var t=a.findItemById(a.state.items,e);a.setState({title:t.title,itemId:t.id,description:t.description,isNewItemModalShow:!0})},a.showLinkPathToItem=function(e){return"/projects/".concat(a.state.projectId,"/paperedits/").concat(e)},a.handleUpdateList=function(e){a.setState({items:e})},a.handleShowCreateNewItemForm=function(){a.setState({isNewItemModalShow:!0})},a.handleCloseModal=function(){a.setState({title:"",itemId:null,description:"",isNewItemModalShow:!1})},a.state={projectId:a.props.projectId,items:[],isNewItemModalShow:!1,title:"",description:"",itemId:null},a.handleDeleteItem=a.handleDeleteItem.bind(Object(v.a)(a)),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(g.a)(b.a.mark(function e(){var t,a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.getAllPaperEdits(this.state.projectId);case 2:t=e.sent,console.log("ApiWrapper.getAllPaperEdits",t),t&&(a=t.map(function(e){return e.display=!0,e}),this.setState({items:a}));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleDeleteItem",value:function(){var e=Object(g.a)(b.a.mark(function e(t){var a;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.deletePaperEdit(this.state.projectId,t);case 2:e.sent.ok&&(a=this.state.items.filter(function(e){return e.id!==t}),this.setState({items:a}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(w.a,{style:{marginBottom:"5em",marginTop:"1em"}},r.a.createElement(V,{model:"Paper Edit",items:this.state.items,handleShowCreateNewItemForm:this.handleShowCreateNewItemForm,handleEdit:this.handleEditItem,handleDelete:this.handleDeleteItem,showLinkPath:this.showLinkPathToItem,handleUpdateList:this.handleUpdateList}),r.a.createElement(Y,{title:this.state.title,description:this.state.description,id:this.state.itemId,modalTitle:this.state.itemId?"Edit Paper Edit":"New Paper Edit",show:this.state.isNewItemModalShow,handleCloseModal:this.handleCloseModal,handleSaveForm:this.handleSaveItem})))}}]),t}(n.Component),Ne=function(e){function t(e,a){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e,a))).state={key:"transcripts",projectId:n.props.match.params.projectId,projectName:"Projects Name"},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(g.a)(b.a.mark(function e(){var t;return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.getProject(this.state.projectId);case 2:(t=e.sent)&&this.setState({projectName:t.project.title});case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,null),r.a.createElement(w.a,{style:{marginBottom:"5em",marginTop:"1em"}},r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:12,md:12,ld:12,xl:12},r.a.createElement(Z,{items:[{name:"Projects",link:"/projects"},{name:this.state.projectName}]}))),r.a.createElement(be.a,{id:"controlled-tab-example",activeKey:this.state.key,onSelect:function(t){return e.setState({key:t})}},r.a.createElement(Ee.a,{eventKey:"transcripts",title:"Transcripts"},r.a.createElement(Te,{projectId:this.state.projectId})),r.a.createElement(Ee.a,{eventKey:"programmes",title:"Programmes script"},r.a.createElement(Le,{projectId:this.state.projectId})))),r.a.createElement(ae,null))}}]),t}(r.a.Component),De=a(52),Ae=a.n(De),Me=a(19),Fe=a.n(Me),Ue=a(221),Be=a(228),Re=a.n(Be),_e=a(229),We=a.n(_e),Je=a(65),Ge=function(e,t){var a;return function(){var n=arguments;clearTimeout(a),a=setTimeout(function(){e.apply(null,n)},t)}},Ve=a(67),qe=a.n(Ve),ze=a(104),Ke={yellow:"#ffff00",greenyellow:"#adff2f",deepskyblue:"#00bfff",deeppink:"#ff1493",aqua:"#00ffff",black:"#000000",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chocolate:"#d2691e",coral:"#ff7f50",crimson:"#dc143c",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",blue:"#0000ff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",chartreuse:"#7fff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",yellowgreen:"#9acd32",aquamarine:"#7fffd4",mediumaquamarine:"#66cdaa"},He=Object.freeze(Object.keys(Ke).splice(0,15)),Xe=[];for(var Ye in Ke)Xe.push({value:Ye,label:Ye,color:Ke[Ye]});var $e=-1,Qe=He.length,Ze=function(){return $e<Qe?$e+=1:$e=0,He[$e]},et=a(46),tt=a.n(et),at=function(e){function t(e,a){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e,a))).handleRandomiseColor=function(){n.setState({color:Ze()})},n.handleColorPickerChangeComplete=function(e){n.setState({color:tt()(e.hex).name()})},n.handleManualColorChange=function(e){if(e&&e.target&&e.target.value){var t=e.target.value;n.setState({color:tt.a.valid(t)?tt()(t).name():t})}else e&&e.target&&""===e.target.value&&n.setState({color:""})},n.handleColorSelectChange=function(e){n.setState({color:e.color})},n.handleSave=function(){tt.a.valid(n.state.color)?""!==n.state.label?(n.props.onLabelSaved({value:n.state.color,label:n.state.label,color:n.state.color,description:n.state.description,id:n.state.labelId}),n.props.handleClose()):alert("add a name to the label to be able to save"):alert("choose a valid color")},n.state={color:n.props.color,label:n.props.label,description:n.props.description,labelId:n.props.labelId},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,null,r.a.createElement(H.a.Group,{controlId:"formGroupEmail"},r.a.createElement(H.a.Label,null,"Label Name "),r.a.createElement(H.a.Control,{type:"text",placeholder:"Enter label name",defaultValue:this.state.label,onInput:function(t){e.setState({label:t.target.value})}}),r.a.createElement(H.a.Text,{className:"text-muted"},"Required label name")),r.a.createElement(H.a.Group,{controlId:"formGroupPassword"},r.a.createElement(H.a.Label,null,"Label Description"),r.a.createElement(H.a.Control,{type:"text",placeholder:"Enter label description",defaultValue:this.state.description,as:"textarea",rows:"3",onInput:function(t){e.setState({description:t.target.value})}}),r.a.createElement(H.a.Text,{className:"text-muted"},"Optional label description")),r.a.createElement(H.a.Group,{controlId:"formGroupPassword"},r.a.createElement(H.a.Label,null,"Color"),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:2,sm:1,md:1,lg:1,xl:1},r.a.createElement(M.a,{onClick:this.handleRandomiseColor,variant:"light",size:"sm"},r.a.createElement(I.a,{icon:T.F}))),r.a.createElement(x.a,{xs:6,sm:6,md:6,lg:6,xl:6},r.a.createElement(H.a.Control,{value:this.state.color,type:"text",placeholder:"#",onChange:this.handleManualColorChange})),r.a.createElement(x.a,{xs:2,sm:2,md:2,lg:2,xl:2,style:{backgroundColor:this.state.color,border:"solid",borderWidth:"0.01em",borderColor:"grey",padding:"0"}})),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:12,md:12,lg:12,xl:12},r.a.createElement(H.a.Text,{className:"text-muted"},"To pick a color you can chose one at random, pick one form the list below, or type the name or hex code above."),r.a.createElement(ze.GithubPicker,{width:"100%",color:this.state.color,triangle:"hide",onChangeComplete:this.handleColorPickerChangeComplete,colors:He})))),r.a.createElement(M.a,{variant:"primary",onClick:this.handleSave},"Save")))}}]),t}(n.Component),nt=function(e){function t(e,a){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e,a))).handleClose=function(){n.setState({show:!1})},n.handleShow=function(){n.setState({show:!0})},n.state={show:!1,color:n.props.color,label:n.props.label,description:n.props.description,labelId:n.props.labelId},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(M.a,{variant:"link",size:"sm",onClick:this.handleShow,block:!0},this.props.openBtn),r.a.createElement(z.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(z.a.Header,{closeButton:!0},r.a.createElement(z.a.Title,null,r.a.createElement(I.a,{icon:T.G}),"  Label ")),r.a.createElement(z.a.Body,null,r.a.createElement(at,{onLabelSaved:this.props.onLabelSaved,label:this.props.label,description:this.props.description,color:this.props.color,labelId:this.props.labelId,handleClose:this.handleClose}))))}}]),t}(n.Component),rt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).removeLabel=function(e,t){!0===confirm("Click OK to delete the label, Cancel if you changed your mind")?a.props.onLabelDelete(e):alert("Your label was not deleted")},a.editLabel=function(e,t){var n=a.props.labelsOptions.filter(function(t){return t.id===e});console.log("labelToEdit",n)},a.onLabelSaved=function(e){e.id?a.props.onLabelUpdate(e):a.props.onLabelCreate(e)},a.showLabelModal=function(){console.log(a.state.isLabelmodalShown),a.setState(function(e){return{isLabelmodalShown:!e.isLabelmodalShown}})},a.state={isLabelmodalShown:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=this;this.props.labelsOptions&&(e=this.props.labelsOptions.map(function(e,a){return r.a.createElement(qe.a.Item,{key:"label_"+a},r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1,style:{backgroundColor:e.color},title:e.label}),r.a.createElement(x.a,{xs:7,sm:7,md:7,lg:7,xl:7},e.label),r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1},"default"!==e.label.toLowerCase()?r.a.createElement(nt,{color:e.color,label:e.label,description:e.description,labelId:e.id,show:t.state.isLabelmodalShown,onLabelSaved:t.onLabelSaved,openBtn:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.w}))}):r.a.createElement(M.a,{title:"edit label",variant:"link",size:"sm",disabled:!0},r.a.createElement(I.a,{icon:T.w})," ")),r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1},r.a.createElement(M.a,{title:"delete label",variant:"link",size:"sm",onClick:function(a){t.removeLabel(e.id,a)},disabled:"default"===e.label.toLowerCase()},r.a.createElement(I.a,{icon:T.J})))),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1,title:e.label}),r.a.createElement(x.a,{xs:10,sm:10,md:10,lg:10,xl:10},r.a.createElement(H.a.Text,{className:"text-muted"},e.description))))}));var a=r.a.createElement(qe.a,{style:{height:"30vh",overflow:"scroll"}},e);return r.a.createElement(r.a.Fragment,null,this.props.isLabelsListOpen?r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement(D.a,null,r.a.createElement(D.a.Header,null,r.a.createElement(I.a,{icon:T.G}),r.a.createElement(I.a,{icon:T.h})," Labels Options"),a,r.a.createElement(D.a.Footer,{className:"text-muted"},r.a.createElement(nt,{color:Ze(),label:"",description:"",labelId:null,show:this.state.isLabelmodalShown,onLabelSaved:this.onLabelSaved,openBtn:r.a.createElement(M.a,{variant:"outline-secondary",block:!0},r.a.createElement(I.a,{icon:T.G})," Create New Label")})))):"")}}]),t}(n.Component),st=function(e){return e.replace(/\.|\?|!|,|;/,"").toLowerCase()},ot=function(e,t){var a=t.filter(function(t){return e.start>t.start});return 0!==a.length&&a},lt=function(e,t){var a=t.filter(function(t){return e.end<t.end});return 0!==a.length&&a},it=function(e,t){var a=t.find(function(t){return e.start===t.start}),n=t.indexOf(a),r=t.find(function(t){return e.end===t.end}),s=t.indexOf(r);return t.slice(n,s+1)},ct=function(e,t){return{wordsBefore:ot(e,t),wordsInAnnotation:it(e,t),wordsAfter:lt(e,t)}},dt=function(e,t){var a=function(e,t,a){return e.find(function(e){return e.start>=t&&e.end<=a})}(e,t[0].start,t[t.length-1].end);return a||!1};var pt=function(e,t){return function(e){var t=e[0].speaker,a=[],n={words:[],text:"",speaker:""};return e.forEach(function(e){t===e.speaker?(delete e.speaker,n.words.push(e),n.text+=e.text+" ",n.speaker=t):(t=e.speaker,n.text=n.text.trim(),a.push(n),(n={words:[],text:"",speaker:"U_UKN"}).words.push(e),n.text+=e.text+" ")}),a.push(n),a}(function(e,t){return e.map(function(e){return e.speaker=function(e,t){var a=t.find(function(t){return e.start>=t.start&&e.end<=t.end});return void 0===a?"UKN":a.speaker}(e,t),e})}(e,t))},ht=a(24),ut=a(143),mt=a.n(ut),ft=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.paragraphDisplayPreference;e.borderStyle="dashed",e.borderWidth="0.01em",e.borderColor="lightgray",e.padding="0.5em";var t={};return this.props.showParagraphsMatchingSearch?t=this.props.paragraphDisplayPreference:e.display||(delete e.display,t.borderRight="0.1em dashed lightgrey",t.borderLeft="0.1em dashed lightgrey"),r.a.createElement(y.a,{style:Object(ht.a)({},t),className:"paragraph","data-paragraph-text":this.props.paragraphTextWithoutPunctuation},r.a.createElement(x.a,{xs:12,sm:12,md:3,lg:3,xl:2,style:{cursor:"pointer",width:"100%"},className:"text-truncate",title:"".concat(this.props.speakerName.toUpperCase()," -  ").concat(Object(Je.shortTimecode)(this.props.paragraph[0].start))},r.a.createElement("span",{className:[mt.a.speaker,mt.a.unselectable,"timecode"].join(" "),"data-start":this.props.paragraph[0].start,tabIndex:"0"},this.props.speakerName)),r.a.createElement(x.a,{xs:12,sm:12,md:9,lg:9,xl:10},this.props.wordsElements))}}]),t}(n.Component),bt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).generatePreviousTimes=function(e){for(var t="",a=0;a<e;a++)t+="".concat(a," ");if(e%1>0){var n=Math.floor(e%1*4)/4;t+=" ".concat(Math.floor(e)+n)}return t},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.transcriptId,n=t.speaker,s=this.props.paragraph.map(function(t){return r.a.createElement("span",{title:"start:".concat(t.start," - end:").concat(t.end),"data-prev-times":e.generatePreviousTimes(t.start),className:["words"].join(" "),"data-start":t.start,"data-text":st(t.text),"data-end":t.end,"data-transcript-id":a,"data-speaker":n,key:"key_"+t.id+"_"+t.end,role:"button","aria-pressed":"false",onKeyDown:e.props.handleKeyDownWords},t.text," ")});return r.a.createElement(r.a.Fragment,null,s)}}]),t}(n.Component),gt=a(106),Et=a.n(gt),vt=a(105),St=a.n(vt),wt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleEditAnnotation=function(){a.props.handleEditAnnotation(a.props.annotationId,void 0)},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.annotationLabelId;if(this.props.labelsOptions){var n=this.props.labelsOptions.find(function(e){return console.log(e.id,a),e.id===a});n||(n=this.props.labelsOptions[0]),e=r.a.createElement(St.a,{rootClose:!0,trigger:"click",placement:"bottom",overlay:r.a.createElement(Et.a,{id:"popover-basic"},r.a.createElement(y.a,null,r.a.createElement(x.a,{md:1,style:{backgroundColor:n.color,marginLeft:"1em"}}),r.a.createElement(x.a,null,r.a.createElement(I.a,{icon:T.G}),"  ",n.label),r.a.createElement(x.a,{md:1,style:{marginRight:"1em"},onClick:function(){t.props.handleDeleteAnnotation(t.props.annotationId)}},r.a.createElement(I.a,{icon:T.L}))),r.a.createElement("hr",null),r.a.createElement(I.a,{icon:T.C,onClick:this.handleEditAnnotation}),"   ",this.props.annotationNote,r.a.createElement("br",null),r.a.createElement(I.a,{icon:T.w,onClick:this.handleEditAnnotation}))},r.a.createElement("span",{style:{borderBottom:"0.1em ".concat(n.color," solid")},className:"highlight"},this.props.words))}return r.a.createElement(r.a.Fragment,null,e)}}]),t}(n.Component);var kt=function(e,t,a){var n={};return e||(n={display:"none"}),t||(n={display:"none"}),a||(n={display:"none"}),n};var yt=function(e){var t,a={},n=e.annotations,s=e.transcriptId;return pt(e.transcriptJson.words,e.transcriptJson.paragraphs).map(function(o,l){var i=st(o.text),c=dt(n,o.words),d=i.includes(e.searchString.toLowerCase()),p=!1;0!==e.selectedOptionSpeakerSearch.length?e.selectedOptionSpeakerSearch.find(function(e){return e.label===o.speaker})&&(p=!0):p=!0;var h=!1;if(0!==e.selectedOptionLabelSearch.length?e.selectedOptionLabelSearch.find(function(e){return e.id===c.labelId})&&(h=!0):h=!0,a=kt(d,p,h),c){var u=ct(c,o.words),m=u.wordsBefore,f=u.wordsInAnnotation,b=u.wordsAfter,g=m?r.a.createElement(bt,{transcriptId:s,speaker:o.speaker,key:"key-"+l,paragraph:m,handleKeyDownWords:function(t){return"Enter"===t.key?e.handleWordClick(t):null}}):null,E=r.a.createElement(bt,{transcriptId:s,speaker:o.speaker,key:"key--"+l,paragraph:f,handleKeyDownWords:function(t){return"Enter"===t.key?e.handleWordClick(t):null}}),v=b?r.a.createElement(bt,{transcriptId:s,speaker:o.speaker,key:"key---"+l,paragraph:b,handleKeyDownWords:function(t){return"Enter"===t.key?e.handleWordClick(t):null}}):null;t=[g,r.a.createElement(wt,{key:"key----"+l,words:E,labelsOptions:e.labelsOptions,annotationLabelId:c.labelId,annotationId:c.id,annotationNote:c.note,handleDeleteAnnotation:e.handleDeleteAnnotation,handleEditAnnotation:e.handleEditAnnotation}),v]}else t=r.a.createElement(bt,{transcriptId:s,speaker:o.speaker,key:"key-----"+l,paragraph:o.words,handleKeyDownWords:function(t){return"Enter"===t.key?e.handleWordClick(t):null}});return r.a.createElement(ft,{showParagraphsMatchingSearch:e.showParagraphsMatchingSearch,paragraphDisplayPreference:a,key:"key------"+l,paragraphTextWithoutPunctuation:i,speakerName:o.speaker,paragraph:o.words,handleKeyDownTimecodes:function(t){return"Enter"===t.key?e.handleTimecodeClick(t):null},wordsElements:t})})},jt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleKeyDownTimecodes=function(e){"Enter"===e.key&&a.props.handleTimecodeClick(e)},a.handleKeyDownWords=function(e){"Enter"===e.key&&a.props.handleWordClick(e)},a.generateParagraphsEl=function(){return yt(a.props)},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.generateParagraphsEl())}}]),t}(n.Component),xt=a(66),Ot=a.n(xt),Ct=a(68),Pt={control:function(e){return Object(ht.a)({},e,{backgroundColor:"white"})},option:function(e,t){var a=t.data,n=t.isDisabled,r=(t.isFocused,t.isSelected,a.color);return Object(ht.a)({},e,{backgroundColor:null,borderLeft:"1.5em solid",borderColor:r,marginBottom:"0.4em",cursor:n?"not-allowed":"default"})},multiValue:function(e,t){var a=t.data;return Object(ht.a)({},e,{backgroundColor:"white",border:"0.05em solid",borderLeft:"1.2em solid",borderColor:a.color})},multiValueLabel:function(e,t){t.data;return Object(ht.a)({},e)},multiValueRemove:function(e,t){t.data;return Object(ht.a)({},e)}},It={control:function(e){return Object(ht.a)({},e,{backgroundColor:"white"})},option:function(e){return Object(ht.a)({},e,{backgroundColor:null,cursor:"default"})},multiValue:function(e){return Object(ht.a)({},e,{backgroundColor:"white",border:"0.05em solid grey"})},multiValueLabel:function(e){return Object(ht.a)({},e)},multiValueRemove:function(e){return Object(ht.a)({},e)}},Tt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleToggleSearchTextPreferences=function(){a.setState(function(e){return{showTextSearchPreferences:!e.showTextSearchPreferences}})},a.handleToggleSearchLabelsPreferences=function(){a.setState(function(e){return{showLabelsSearchPreferences:!e.showLabelsSearchPreferences}})},a.handleToggleSearchSpeakersPreferences=function(){a.setState(function(e){return{showSpeakersSearchPreferences:!e.showSpeakersSearchPreferences}})},a.handleSpeakersSearchChange=function(e){a.props.handleSpeakersSearchChange(e),a.setState({selectedOptionSpeakerSearch:e})},a.handleLabelsSearchChange=function(e){a.props.handleLabelsSearchChange(e),a.setState({selectedOptionLabelSearch:e})},a.handleShowParagraphsMatchingSearch=function(){a.setState(function(e){return{showParagraphsMatchingSearch:!e.showParagraphsMatchingSearch}},function(){a.props.handleShowParagraphsMatchingSearch()})},a.handleToggleAll=function(){a.setState(function(e){return{showTextSearchPreferences:!0,showSpeakersSearchPreferences:!0,showLabelsSearchPreferences:!0,showParagraphsMatchingSearch:!0}},function(){a.props.handleShowParagraphsMatchingSearch()})},a.handleHideAll=function(){a.setState(function(e){return{showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1,showParagraphsMatchingSearch:!1}},function(){a.props.handleShowParagraphsMatchingSearch()})},a.state={showParagraphsMatchingSearch:!1,showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a.Header,null,r.a.createElement(_.a,{className:"mb-3"},r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,null,r.a.createElement(I.a,{icon:T.A}))),r.a.createElement(J.a,{onChange:function(t){e.props.handleSearch(t,{showParagraphsMatchingSearch:e.state.showParagraphsMatchingSearch,showLabelsSearchPreferences:e.state.showLabelsSearchPreferences,showSpeakersSearchPreferences:e.state.showSpeakersSearchPreferences})},placeholder:"Search text...","aria-label":"search","aria-describedby":"search"}),r.a.createElement(Ot.a,{drop:"right",as:_.a.Append,variant:"outline-secondary",title:r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{icon:T.m,title:"Filter results"}))},r.a.createElement(Fe.a.Item,{onClick:this.handleToggleSearchLabelsPreferences,title:"Filter results by Labels"},r.a.createElement(I.a,{icon:T.G}),"  Labels ",this.state.showLabelsSearchPreferences?r.a.createElement(I.a,{style:{color:"blue"},icon:T.f}):""),r.a.createElement(Fe.a.Item,{onClick:this.handleToggleSearchSpeakersPreferences,title:"Filter results by Speakers"},r.a.createElement(I.a,{icon:T.M})," Speakers  ",this.state.showSpeakersSearchPreferences?r.a.createElement(I.a,{style:{color:"blue"},icon:T.f}):""),r.a.createElement(Fe.a.Item,{onClick:this.handleToggleSearchTextPreferences,title:"Show only matching paragraphs"},r.a.createElement(I.a,{icon:T.a})," Paragraphs only ",this.state.showTextSearchPreferences?r.a.createElement(I.a,{style:{color:"blue"},icon:T.f}):""),r.a.createElement(Fe.a.Item,{onClick:this.handleToggleAll,title:"Show all of the above options"},"All ",this.state.showLabelsSearchPreferences&&this.state.showSpeakersSearchPreferences&&this.state.showTextSearchPreferences?r.a.createElement(I.a,{style:{color:"blue"},icon:T.f}):""),r.a.createElement(Fe.a.Divider,null),r.a.createElement(Fe.a.Item,{onClick:this.handleHideAll,title:"Deselect all the options"},"Deselect all"))),this.state.showLabelsSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{className:"mb-3"},r.a.createElement(x.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,null,r.a.createElement(I.a,{icon:T.G})))),r.a.createElement(x.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(Ct.a,{value:this.state.selectedOptionLabelSearch,onChange:this.handleLabelsSearchChange,isMulti:!0,isSearchable:!0,options:this.props.labelsOptions,styles:Pt,placeholder:"Filter by label..."})))):"",this.state.showSpeakersSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{className:"mb-3"},r.a.createElement(x.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,null,r.a.createElement(I.a,{icon:T.M})))),r.a.createElement(x.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(Ct.a,{value:this.state.selectedOptionSpeakerSearch,onChange:this.handleSpeakersSearchChange,isMulti:!0,isSearchable:!0,options:this.props.speakersOptions,styles:It,placeholder:"Filter by speaker..."})))):"",this.state.showTextSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a.Check,{type:"checkbox",checked:this.state.showParagraphsMatchingSearch,onChange:this.handleShowParagraphsMatchingSearch,label:r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a.Text,{className:"text-muted",title:"Show only matching paragraphs",onClick:this.handleShowParagraphsMatchingSearch},"Show only matching paragraphs"))})):""))}}]),t}(n.Component),Lt=function(e){return[{name:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.o})," Projects"),link:"/projects"},{name:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.p})," NewProject"),link:"/projects/new"},{name:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.l})," Transcripts"),link:"/projects/".concat(e,"/transcripts")},{name:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.k})," New Transcript"),link:"/projects/".concat(e,"/transcripts/new")},{name:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.I})," Paper Edits"),link:"/projects/".concat(e,"/paperedits")},{name:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.i})," New Paper Edit"),link:"/projects/".concat(e,"/paperedits/new")},{name:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.N})," Users"),link:"/projects/".concat(e,"/users")}]};var Nt=function(e){if(!window.getSelection().isCollapsed){var t=window.getSelection().getRangeAt(0).cloneContents().querySelectorAll(".words");if(0!==t.length)return{start:parseFloat(t[0].dataset.start),end:parseFloat(t[t.length-1].dataset.end)};var a=window.getSelection().anchorNode.parentElement;return"words"===a.className&&{start:parseFloat(a.dataset.start),end:parseFloat(a.dataset.end)}}return!1};a(474);function Dt(e){var t=[],a=new Map,n=!0,r=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=o.value;a.has(i.speaker)||(a.set(i.speaker,!0),t.push({value:i.speaker,label:i.speaker}))}}catch(c){r=!0,s=c}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return t}var At=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=function(){ue.get_TranscriptLabelsAnnotations(a.state.projectId,a.state.transcriptId).then(function(e){console.log("TranscriptAnnotate",e.transcriptId),a.setState({projectTitle:e.projectTitle,transcriptJson:e.transcript,annotations:e.annotations,transcriptTitle:e.transcriptTitle,url:e.url,labelsOptions:e.labels,speakersOptions:Dt(e.transcript.paragraphs)})}).catch(function(e){a.setState({notification:r.a.createElement(Ce,{dismissable:!0,variant:"danger",heading:"Server Error",message:r.a.createElement("p",null,"Error reaching the server to fetch transcript ")})})})},a.handleWordClick=function(e){if("words"===e.target.className){var t=e.target;a.videoRef.current.currentTime=t.dataset.start,a.videoRef.current.play()}},a.handleTimecodeClick=function(e){if(e.target.classList.contains("timecode")){var t=e.target;a.videoRef.current.currentTime=t.dataset.start,a.videoRef.current.play()}},a.handleSearch=function(e,t){if(""!==e.target.value){var n=e.target.value;a.setState({searchString:n.toLowerCase()}),Ge(a.highlightWords(n),500)}else""===e.target.value&&a.setState({sentenceToSearchCSS:"",searchString:""})},a.highlightWords=function(e){var t=e.toLowerCase().trim().split(" "),n='.paragraph[data-paragraph-text*="'.concat(t.join(" "),'"]'),r=t.map(function(e,a){var r="".concat(n,' > div > span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return a<t.length-1&&(r+=", "),r}),s=t.map(function(e,a){var r="".concat(n,' > div  > span >span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return a<t.length-1&&(r+=", "),r});a.setState({sentenceToSearchCSS:r.join(" "),sentenceToSearchCSSInHighlights:s.join(" ")})},a.onLabelCreate=function(e){ue.createLabel(a.state.projectId,e).then(function(e){a.setState({labelsOptions:e.labels})})},a.onLabelUpdate=function(e){ue.updateLabel(a.state.projectId,e.id,e).then(function(e){a.setState({labelsOptions:e.labels})})},a.onLabelDelete=function(e){ue.deleteLabel(a.state.projectId,e).then(function(e){a.setState({labelsOptions:e.labels})})},a.handleTimeUpdate=function(e){var t=e.target.currentTime;a.setState({currentTime:t})},a.onLoadedDataGetDuration=function(e){var t=e.target.duration+a.state.timecodeOffset,n=Object(Je.secondsToTimecode)(t);a.setState({mediaDuration:n})},a.handleShowParagraphsMatchingSearch=function(){a.setState(function(e){return{showParagraphsMatchingSearch:!e.showParagraphsMatchingSearch}})},a.redirectToEditPage=function(){a.setState({redirect:!0})},a.renderRedirect=function(){if(a.state.redirect)return r.a.createElement(Ue.a,{to:"/projects/".concat(a.state.projectId,"/transcripts/").concat(a.state.transcriptId,"/correct")})},a.handleCreateAnnotation=function(e){var t=e.target;window.element=t;var n=Nt();if(n){var r=a.state.annotations;n.labelId=t.dataset.labelId,n.note="";var s=n;ue.createAnnotation(a.state.projectId,a.state.transcriptId,s).then(function(e){s.id=e.annotation.id,r.push(s),a.setState({annotations:r})})}else alert("Select some text in the transcript to highlight ")},a.handleDeleteAnnotation=function(e){var t=a.state.annotations.filter(function(t){return t.id!==e});ue.deleteAnnotation(a.state.projectId,a.state.transcriptId,e).then(function(e){a.setState({annotations:t})})},a.handleEditAnnotation=function(e){var t=a.state.annotations,n=t.find(function(t){return t.id===e}),r=prompt("Edit the text note of the annotation",n.note);r?(n.note=r,ue.updateAnnotation(a.state.projectId,a.state.transcriptId,e,n).then(function(n){var r=n.annotation,s=t.filter(function(t){return t.id!==e});s.push(r),a.setState({annotations:s})})):alert("all good nothing changed")},a.handleLabelsSearchChange=function(e){a.setState({selectedOptionLabelSearch:e})},a.handleSpeakersSearchChange=function(e){a.setState({selectedOptionSpeakerSearch:e})},a.handleLabelListOpen=function(){a.setState(function(e){return{isLabelsListOpen:!e.isLabelsListOpen}})},a.videoRef=r.a.createRef(),a.state={projectId:a.props.match.params.projectId,transcriptId:a.props.match.params.transcriptId,projectTitle:"",transcriptJson:null,transcriptTitle:"",url:null,mediaDuration:"00:00:00:00",currentTime:0,timecodeOffset:0,searchString:"",sentenceToSearchCSS:"",sentenceToSearchCSSInHighlights:"",wordsToSearchCSS:"",showTextSearchPreferences:!1,showLabelsSearchPreferences:!1,showSpeakersSearchPreferences:!1,showSelectedOptionLabelSearch:!1,selectedOptionLabelSearch:[],selectedOptionSpeakerSearch:[],showParagraphsMatchingSearch:!1,notification:null,annotations:[],labelsOptions:[],speakersOptions:[],isLabelsListOpen:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state.currentTime,a=Math.round(4*t)/4,n=r.a.createElement("style",{scoped:!0},'span.words[data-prev-times~="'.concat(Math.floor(a),'"][data-transcript-id="').concat(this.state.transcriptId,'"] { color: ').concat("grey"," }"));return r.a.createElement(r.a.Fragment,null,this.renderRedirect(),r.a.createElement(w.a,{fluid:!0,style:{backgroundColor:"#f9f9f9",marginBottom:"5em"}},r.a.createElement("style",{scoped:!0},""),r.a.createElement("style",{scoped:!0},"".concat(this.state.sentenceToSearchCSS," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }"),"".concat(this.state.sentenceToSearchCSSInHighlights," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }")),r.a.createElement(L,{links:Lt(this.state.projectId)}),r.a.createElement("br",null),this.state.notification,r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:12,md:10,ld:10,xl:10},r.a.createElement(Z,{items:[{name:"Projects",link:"/projects"},{name:"Project: ".concat(this.state.projectTitle),link:"/projects/".concat(this.state.projectId)},{name:"Transcripts"},{name:"".concat(this.state.transcriptTitle)},{name:"Annotate"}]})),r.a.createElement(x.a,{xs:12,sm:2,md:2,ld:2,xl:2},r.a.createElement(M.a,{variant:"outline-secondary",title:"correct transcript text",onClick:this.redirectToEditPage,size:"lg",block:!0},"Edit"),r.a.createElement("br",null))),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:12,md:12,lg:12,xl:12},r.a.createElement(Re.a,{mediaDuration:this.state.mediaDuration,hookSeek:function(t){return e.setCurrentTime=t},hookPlayMedia:function(t){return e.playMedia=t},hookIsPlaying:function(t){return e.isPlaying=t},rollBackValueInSeconds:15,timecodeOffset:this.state.timecodeOffset,mediaUrl:this.state.url,videoRef:this.videoRef,handleSaveTranscript:function(){alert("feature not implemented yet")}}),r.a.createElement("br",null))),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:3,md:3,lg:3,xl:3,style:{paddingRight:"0"}},null!==this.state.transcriptJson&&r.a.createElement(We.a,{tabindex:"0",role:"button","aria-pressed":"false",mediaUrl:this.state.url,onTimeUpdate:this.handleTimeUpdate,videoRef:this.videoRef,previewIsDisplayed:!0,onLoadedDataGetDuration:this.onLoadedDataGetDuration}),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:9,sm:9,md:8,lg:9,xl:9},r.a.createElement(Fe.a,{as:Ae.a,style:{width:"100%"}},r.a.createElement(M.a,{variant:"warning",id:"defaultHighlightBtn","data-label-id":0,onClick:this.handleCreateAnnotation},r.a.createElement(I.a,{icon:T.s,flip:"horizontal"})," Highlight"),r.a.createElement(Fe.a.Toggle,{split:!0,variant:"warning",id:"dropdown-split-basic","data-lable-id":0}),r.a.createElement(Fe.a.Menu,{onClick:this.handleCreateAnnotation},this.state.labelsOptions&&this.state.labelsOptions.map(function(e){return r.a.createElement(Fe.a.Item,{key:"label_id_".concat(e.id),"data-label-id":e.id},r.a.createElement(y.a,{"data-label-id":e.id},r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1,style:{backgroundColor:e.color},"data-label-id":e.id}),r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1,"data-label-id":e.id},e.label)))})))),r.a.createElement(x.a,{xs:3,sm:3,md:4,lg:3,xl:3},r.a.createElement(M.a,{variant:"outline-secondary",block:!0,onClick:this.handleLabelListOpen,title:"View labels options"},r.a.createElement(I.a,{icon:T.G}),r.a.createElement(I.a,{icon:T.h})))),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:12,md:12,lg:12,xl:12},r.a.createElement(H.a.Text,{className:"text-muted"},"Select some text in the transcript then click the highlight button.",r.a.createElement("br",null),"You can choose btween default or custom labels to categorise your annotations."))),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:12,md:12,lg:12,xl:12},r.a.createElement(rt,{isLabelsListOpen:this.state.isLabelsListOpen,labelsOptions:this.state.labelsOptions&&this.state.labelsOptions,onLabelUpdate:this.onLabelUpdate,onLabelCreate:this.onLabelCreate,onLabelDelete:this.onLabelDelete}))),r.a.createElement("br",null)),r.a.createElement(x.a,{xs:12,sm:9,md:9,lg:9,xl:9},r.a.createElement(D.a,null,r.a.createElement(Tt,{labelsOptions:this.state.labelsOptions,speakersOptions:this.state.speakersOptions,handleSearch:this.handleSearch,handleLabelsSearchChange:this.handleLabelsSearchChange,handleSpeakersSearchChange:this.handleSpeakersSearchChange,handleShowParagraphsMatchingSearch:this.handleShowParagraphsMatchingSearch}),r.a.createElement(D.a.Body,{onDoubleClick:this.handleWordClick,onClick:this.handleTimecodeClick,style:{height:"80vh",overflow:"scroll"}},n,this.state.transcriptJson&&r.a.createElement(jt,{labelsOptions:this.state.labelsOptions&&this.state.labelsOptions,annotations:this.state.annotations,transcriptJson:this.state.transcriptJson,searchString:this.state.searchString,showParagraphsMatchingSearch:this.state.showParagraphsMatchingSearch,selectedOptionLabelSearch:this.state.selectedOptionLabelSearch,selectedOptionSpeakerSearch:this.state.selectedOptionSpeakerSearch,transcriptId:this.state.transcriptId,handleTimecodeClick:this.handleTimecodeClick,handleWordClick:this.handleWordClick,handleDeleteAnnotation:this.handleDeleteAnnotation,handleEditAnnotation:this.handleEditAnnotation}))))),r.a.createElement(ae,null)))}}]),t}(n.Component),Mt=a(234),Ft=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=function(){ue.getTranscript(a.state.projectId,a.state.transcriptId).then(function(e){a.setState({projectTitle:e.projectTitle,transcriptTitle:e.transcriptTitle,transcriptJson:e.transcript,url:e.url})})},a.saveToServer=function(){alert("save to server");var e=a.transcriptEditorRef.current.getEditorContent("digitalpaperedit").data;e.title=a.state.transcriptTitle,e.transcriptTitle=a.state.transcriptTitle;ue.updateTranscript(a.state.projectId,a.state.transcriptId,!1,e).then(function(e){console.log("ApiWrapper.updateTranscript",e),e.ok&&(console.log("updated"),a.setState({savedNotification:r.a.createElement(Ce,{dismissable:!0,variant:"success",heading:"Transcript saved",message:r.a.createElement("p",null,"Transcript: ",r.a.createElement("b",null,a.state.transcriptTitle)," has been saved")})}))}).catch(function(e){console.error("error saving transcript:: ",e),a.setState({savedNotification:r.a.createElement(Ce,{dismissable:!0,variant:"danger",heading:"Error saving transcript",message:r.a.createElement("p",null,"There was an error trying to save this transcript: ",r.a.createElement("b",null,a.state.transcriptTitle))})})})},a.redirectToAnnotatePage=function(){a.setState({redirect:!0})},a.renderRedirect=function(){if(a.state.redirect)return r.a.createElement(Ue.a,{to:"/projects/".concat(a.state.projectId,"/transcripts/").concat(a.state.newTranscriptId,"/annotate")})},a.state={projectId:a.props.match.params.projectId,transcriptId:a.props.match.params.transcriptId,transcriptJson:null,url:null,projectTitle:"",transcriptTitle:"",savedNotification:null},a.transcriptEditorRef=r.a.createRef(),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.renderRedirect(),r.a.createElement(w.a,{style:{marginBottom:"5em"},fluid:!0},r.a.createElement(L,{links:Lt(this.state.projectId)}),r.a.createElement("br",null),r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:12,md:11,ld:11,xl:11},r.a.createElement(Z,{items:[{name:"Projects",link:"/projects"},{name:"Project: ".concat(this.state.projectTitle),link:"/projects/".concat(this.state.projectId)},{name:"Transcripts"},{name:"".concat(this.state.transcriptTitle)},{name:"Correct"}]})),r.a.createElement(x.a,{xs:12,sm:1,md:1,ld:1,xl:1},r.a.createElement(M.a,{variant:"outline-secondary",onClick:this.saveToServer,size:"lg",block:!0},"Save"),r.a.createElement("br",null))),this.state.savedNotification,null!==this.state.transcriptJson&&r.a.createElement(Mt.TranscriptEditor,{transcriptData:this.state.transcriptJson,mediaUrl:this.state.url,isEditable:!0,sttJsonType:"digitalpaperedit",ref:this.transcriptEditorRef}),r.a.createElement(ae,null)))}}]),t}(n.Component),Ut=a(81),Bt=a.n(Ut),Rt={control:function(e){return Object(ht.a)({},e,{backgroundColor:"white"})},option:function(e,t){var a=t.data,n=t.isDisabled,r=(t.isFocused,t.isSelected,a.color);return Object(ht.a)({},e,{backgroundColor:null,borderLeft:"1.5em solid",borderColor:r,marginBottom:"0.4em",cursor:n?"not-allowed":"default"})},multiValue:function(e,t){var a=t.data;return Object(ht.a)({},e,{backgroundColor:"white",border:"0.05em solid",borderLeft:"1.2em solid",borderColor:a.color})},multiValueLabel:function(e,t){t.data;return Object(ht.a)({},e)},multiValueRemove:function(e,t){t.data;return Object(ht.a)({},e)}},_t={control:function(e){return Object(ht.a)({},e,{backgroundColor:"white"})},option:function(e){return Object(ht.a)({},e,{backgroundColor:null,cursor:"default"})},multiValue:function(e){return Object(ht.a)({},e,{backgroundColor:"white",border:"0.05em solid grey"})},multiValueLabel:function(e){return Object(ht.a)({},e)},multiValueRemove:function(e){return Object(ht.a)({},e)}},Wt=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handleToggleSearchTextPreferences=function(){a.setState(function(e){return{showTextSearchPreferences:!e.showTextSearchPreferences}})},a.handleToggleSearchLabelsPreferences=function(){a.setState(function(e){return{showLabelsSearchPreferences:!e.showLabelsSearchPreferences}})},a.handleToggleSearchSpeakersPreferences=function(){a.setState(function(e){return{showSpeakersSearchPreferences:!e.showSpeakersSearchPreferences}})},a.handleSpeakersSearchChange=function(e){a.props.handleSpeakersSearchChange(e),a.setState({selectedOptionSpeakerSearch:e})},a.handleLabelsSearchChange=function(e){a.props.handleLabelsSearchChange(e),a.setState({selectedOptionLabelSearch:e})},a.handleShowParagraphsMatchingSearch=function(){a.setState(function(e){return{showParagraphsMatchingSearch:!e.showParagraphsMatchingSearch}},function(){a.props.handleShowParagraphsMatchingSearch()})},a.handleToggleAll=function(){a.setState(function(e){return{showTextSearchPreferences:!0,showSpeakersSearchPreferences:!0,showLabelsSearchPreferences:!0,showParagraphsMatchingSearch:!0}},function(){a.props.handleShowParagraphsMatchingSearch()})},a.handleHideAll=function(){a.setState(function(e){return{showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1,showParagraphsMatchingSearch:!1}},function(){a.props.handleShowParagraphsMatchingSearch()})},a.state={showParagraphsMatchingSearch:!1,showTextSearchPreferences:!1,showSpeakersSearchPreferences:!1,showLabelsSearchPreferences:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a.Header,null,r.a.createElement(_.a,{className:"mb-3"},r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,null,r.a.createElement(I.a,{icon:T.A}))),r.a.createElement(J.a,{onChange:function(t){e.props.handleSearch(t,{showParagraphsMatchingSearch:e.state.showParagraphsMatchingSearch,showLabelsSearchPreferences:e.state.showLabelsSearchPreferences,showSpeakersSearchPreferences:e.state.showSpeakersSearchPreferences})},placeholder:"Search text...","aria-label":"search","aria-describedby":"search"}),r.a.createElement(Ot.a,{drop:"right",as:_.a.Append,variant:"outline-secondary",title:r.a.createElement(r.a.Fragment,null,r.a.createElement(I.a,{icon:T.m,title:"Filter results"}))},r.a.createElement(Fe.a.Item,{onClick:this.handleToggleSearchLabelsPreferences,title:"Filter results by Labels"},r.a.createElement(I.a,{icon:T.G}),"  Labels ",this.state.showLabelsSearchPreferences?r.a.createElement(I.a,{style:{color:"blue"},icon:T.f}):""),r.a.createElement(Fe.a.Item,{onClick:this.handleToggleSearchSpeakersPreferences,title:"Filter results by Speakers"},r.a.createElement(I.a,{icon:T.M})," Speakers  ",this.state.showSpeakersSearchPreferences?r.a.createElement(I.a,{style:{color:"blue"},icon:T.f}):""),r.a.createElement(Fe.a.Item,{onClick:this.handleToggleSearchTextPreferences,title:"Show only matching paragraphs"},r.a.createElement(I.a,{icon:T.a})," Paragraphs only ",this.state.showTextSearchPreferences?r.a.createElement(I.a,{style:{color:"blue"},icon:T.f}):""),r.a.createElement(Fe.a.Item,{onClick:this.handleToggleAll,title:"Show all of the above options"},"All ",this.state.showLabelsSearchPreferences&&this.state.showSpeakersSearchPreferences&&this.state.showTextSearchPreferences?r.a.createElement(I.a,{style:{color:"blue"},icon:T.f}):""),r.a.createElement(Fe.a.Divider,null),r.a.createElement(Fe.a.Item,{onClick:this.handleHideAll,title:"Deselect all the options"},"Deselect all"))),this.state.showLabelsSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{className:"mb-3"},r.a.createElement(x.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,null,r.a.createElement(I.a,{icon:T.G})))),r.a.createElement(x.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(Ct.a,{value:this.state.selectedOptionLabelSearch,onChange:this.handleLabelsSearchChange,isMulti:!0,isSearchable:!0,options:this.props.labelsOptions,styles:Rt,placeholder:"Filter by label..."})))):"",this.state.showSpeakersSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{className:"mb-3"},r.a.createElement(x.a,{xs:1,sm:1,md:1,ld:1,xl:1},r.a.createElement(_.a.Prepend,null,r.a.createElement(_.a.Text,null,r.a.createElement(I.a,{icon:T.M})))),r.a.createElement(x.a,{xs:10,sm:11,md:11,ld:11,xl:11},r.a.createElement(Ct.a,{value:this.state.selectedOptionSpeakerSearch,onChange:this.handleSpeakersSearchChange,isMulti:!0,isSearchable:!0,options:this.props.speakersOptions,styles:_t,placeholder:"Filter by speaker..."})))):"",this.state.showTextSearchPreferences?r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a.Check,{type:"checkbox",checked:this.state.showParagraphsMatchingSearch,onChange:this.handleShowParagraphsMatchingSearch,label:r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a.Text,{className:"text-muted",title:"Show only matching paragraphs",onClick:this.handleShowParagraphsMatchingSearch},"Show only matching paragraphs"))})):""))}}]),t}(n.Component);var Jt=function(e,t){return function(e,t){var a=[],n="UKN",r=0,s=0,o={words:[],text:"",speaker:""};return e.forEach(function(e){(n=function(e,t){return t.find(function(t){if(e.start>=t.start&&e.end<=t.end)return t})}(e,t))&&((r=t.indexOf(n))===s?(o.words.push(e),o.text+=e.text+" ",o.speaker=n.speaker):(s=r,o.text.trim(),a.push(o),(o={words:[],text:"",speaker:""}).words.push(e),o.text+=e.text+" ",o.speaker=n.speaker))}),a.push(o),a}(e,t)},Gt=function(e,t){var a=t[0].start,n=t[t.length-1].end,r=function(e,t,a){return e.find(function(e){return e.start>=t&&e.end<=a})}(e,a,n);if(r)return r;var s=function(e,t,a){return e.find(function(e){return e.start>=t&&e.start<=a})}(e,a,n);if(s)return s;var o=function(e,t,a){return e.find(function(e){return e.end>=t&&e.end<=a})}(e,a,n);if(o)return o;var l=function(e,t,a){return e.find(function(e){return e.start<=t&&e.end>=a})}(e,a,n);return l||!1},Vt=a(145),qt=a.n(Vt),zt=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.paragraphDisplayPreference;e.borderStyle="dashed",e.borderWidth="0.01em",e.borderColor="lightgray",e.padding="0.5em";var t={};return this.props.showParagraphsMatchingSearch?t=this.props.paragraphDisplayPreference:e.display||(delete e.display,t.borderRight="0.1em dashed lightgrey",t.borderLeft="0.1em dashed lightgrey"),r.a.createElement(y.a,{style:Object(ht.a)({},t),className:"paragraph","data-paragraph-text":this.props.paragraphTextWithoutPunctuation},r.a.createElement(x.a,{xs:12,sm:12,md:3,lg:3,xl:2,style:{cursor:"pointer",width:"100%"},className:"text-truncate",title:"".concat(this.props.speakerName.toUpperCase()," -  ").concat(Object(Je.shortTimecode)(this.props.paragraph[0].start))},r.a.createElement("span",{className:[qt.a.speaker,qt.a.unselectable,"timecode"].join(" "),"data-start":this.props.paragraph[0].start,tabIndex:"0"},this.props.speakerName)),r.a.createElement(x.a,{xs:12,sm:12,md:9,lg:9,xl:10},this.props.wordsElements))}}]),t}(n.Component),Kt=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).generatePreviousTimes=function(e){for(var t="",a=0;a<e;a++)t+="".concat(a," ");if(e%1>0){var n=Math.floor(e%1*4)/4;t+=" ".concat(Math.floor(e)+n)}return t},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.transcriptId,a=e.speaker,n=e.word;return r.a.createElement("span",{title:"start:".concat(n.start," - end:").concat(n.end),"data-prev-times":this.generatePreviousTimes(n.start),className:["words"].join(" "),"data-start":n.start,"data-text":st(n.text),"data-end":n.end,"data-transcript-id":t,"data-speaker":a,key:"key_"+n.id+"_"+n.end,role:"button","aria-pressed":"false",onKeyDown:this.props.handleKeyDownWords},n.text," ")}}]),t}(n.Component),Ht=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleEditAnnotation=function(){a.props.handleEditAnnotation(a.props.annotationId,void 0)},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=this;if(console.log("render - AnnotationOverlayTrigger",this.props.annotationNote),this.props.labelsOptions){var a=this.props.labelsOptions.find(function(e){return e.id===t.props.annotationLabelId});a||(a=this.props.labelsOptions[0]),e=r.a.createElement(St.a,{rootClose:!0,trigger:"click",placement:"bottom",overlay:r.a.createElement(Et.a,{id:"popover-basic"},r.a.createElement(y.a,null,r.a.createElement(x.a,{md:1,style:{backgroundColor:a.color,marginLeft:"1em"}}),r.a.createElement(x.a,null,r.a.createElement(I.a,{icon:T.G}),"  ",a.label),r.a.createElement(x.a,{md:1,style:{marginRight:"1em"},onClick:function(){t.props.handleDeleteAnnotation(t.props.annotationId)}},r.a.createElement(I.a,{icon:T.L}))),r.a.createElement("hr",null),r.a.createElement(I.a,{icon:T.C,onClick:this.handleEditAnnotation}),"   ",this.props.annotationNote,r.a.createElement("br",null),r.a.createElement(I.a,{icon:T.w,onClick:this.handleEditAnnotation}))},r.a.createElement("span",{style:{borderBottom:"0.1em ".concat(a.color," solid")},className:"highlight"},this.props.words))}return r.a.createElement(r.a.Fragment,null,e)}}]),t}(n.Component);var Xt=function(e,t,a){var n={};return e||(n={display:"none"}),t||(n={display:"none"}),a||(n={display:"none"}),n},Yt=function(e,t){return e.map(function(e){return e.words=function(e,t){return e.map(function(e){var a=function(e,t,a){return e.find(function(e){return t>=e.start&&a<=e.end})}(t,e.start,e.end);return a?e.annotation=a:delete e.annotation,e})}(e.words,t),e})},$t=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).handleKeyDownTimecodes=function(e){"Enter"===e.key&&a.props.handleTimecodeClick(e)},a.handleKeyDownWords=function(e){"Enter"===e.key&&a.props.handleWordClick(e)},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=this,a={},n=Jt(this.props.transcriptJson.words,this.props.transcriptJson.paragraphs),s=Yt(n,this.props.annotations).map(function(n,s){var o=Gt(t.props.annotations,n.words),l=n.text.replace(/\.|\?|!|,|;/,"").toLowerCase(),i=l.includes(t.props.searchString.toLowerCase()),c=!1;0!==t.props.selectedOptionSpeakerSearch.length?t.props.selectedOptionSpeakerSearch.find(function(e){return e.label===n.speaker})&&(c=!0):c=!0;var d=!1;return 0!==t.props.selectedOptionLabelSearch.length?t.props.selectedOptionLabelSearch.find(function(e){return e.id===o.labelId})&&(d=!0):d=!0,a=Xt(i,c,d),e=n.words.map(function(e,a){var s=r.a.createElement(Kt,{transcriptId:t.props.transcriptId,speaker:n.speaker,key:"key--"+a,word:e,handleKeyDownWords:function(e){return"Enter"===e.key?t.props.handleWordClick(e):null}});return e.annotation?r.a.createElement(Ht,{key:"key----"+a,words:s,labelsOptions:t.props.labelsOptions,annotationLabelId:e.annotation.labelId,annotationId:e.annotation.id,annotationNote:e.annotation.note,handleDeleteAnnotation:t.props.handleDeleteAnnotation,handleEditAnnotation:t.props.handleEditAnnotation}):s}),r.a.createElement(zt,{showParagraphsMatchingSearch:t.props.showParagraphsMatchingSearch,paragraphDisplayPreference:a,key:"key------"+s,paragraphTextWithoutPunctuation:l,speakerName:n.speaker,paragraph:n.words,handleKeyDownTimecodes:function(e){return"Enter"===e.key?t.props.handleTimecodeClick(e):null},wordsElements:e})});return r.a.createElement(r.a.Fragment,null,s)}}]),t}(n.Component),Qt={yellow:"#ffff00",greenyellow:"#adff2f",deepskyblue:"#00bfff",deeppink:"#ff1493",aqua:"#00ffff",black:"#000000",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chocolate:"#d2691e",coral:"#ff7f50",crimson:"#dc143c",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",blue:"#0000ff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",chartreuse:"#7fff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",yellowgreen:"#9acd32",aquamarine:"#7fffd4",mediumaquamarine:"#66cdaa"},Zt=Object.freeze(Object.keys(Qt).splice(0,15)),ea=[];for(var ta in Qt)ea.push({value:ta,label:ta,color:Qt[ta]});var aa=-1,na=Zt.length,ra=function(){return aa<na?aa+=1:aa=0,Zt[aa]},sa=function(e){function t(e,a){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e,a))).handleRandomiseColor=function(){n.setState({color:ra()})},n.handleColorPickerChangeComplete=function(e){n.setState({color:tt()(e.hex).name()})},n.handleManualColorChange=function(e){if(e&&e.target&&e.target.value){var t=e.target.value;n.setState({color:tt.a.valid(t)?tt()(t).name():t})}else e&&e.target&&""===e.target.value&&n.setState({color:""})},n.handleColorSelectChange=function(e){n.setState({color:e.color})},n.handleSave=function(){tt.a.valid(n.state.color)?""!==n.state.label?(n.props.onLabelSaved({value:n.state.color,label:n.state.label,color:n.state.color,description:n.state.description,id:n.state.labelId}),n.props.handleClose()):alert("add a name to the label to be able to save"):alert("choose a valid color")},n.state={color:n.props.color,label:n.props.label,description:n.props.description,labelId:n.props.labelId},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(H.a,null,r.a.createElement(H.a.Group,{controlId:"formGroupEmail"},r.a.createElement(H.a.Label,null,"Label Name "),r.a.createElement(H.a.Control,{type:"text",placeholder:"Enter label name",defaultValue:this.state.label,onInput:function(t){e.setState({label:t.target.value})}}),r.a.createElement(H.a.Text,{className:"text-muted"},"Required label name")),r.a.createElement(H.a.Group,{controlId:"formGroupPassword"},r.a.createElement(H.a.Label,null,"Label Description"),r.a.createElement(H.a.Control,{type:"text",placeholder:"Enter label description",defaultValue:this.state.description,as:"textarea",rows:"3",onInput:function(t){e.setState({description:t.target.value})}}),r.a.createElement(H.a.Text,{className:"text-muted"},"Optional label description")),r.a.createElement(H.a.Group,{controlId:"formGroupPassword"},r.a.createElement(H.a.Label,null,"Color"),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:2,sm:1,md:1,lg:1,xl:1},r.a.createElement(M.a,{onClick:this.handleRandomiseColor,variant:"light",size:"sm"},r.a.createElement(I.a,{icon:T.F}))),r.a.createElement(x.a,{xs:6,sm:6,md:6,lg:6,xl:6},r.a.createElement(H.a.Control,{value:this.state.color,type:"text",placeholder:"#",onChange:this.handleManualColorChange})),r.a.createElement(x.a,{xs:2,sm:2,md:2,lg:2,xl:2,style:{backgroundColor:this.state.color,border:"solid",borderWidth:"0.01em",borderColor:"grey",padding:"0"}})),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:12,md:12,lg:12,xl:12},r.a.createElement(H.a.Text,{className:"text-muted"},"To pick a color you can chose one at random, pick one form the list below, or type the name or hex code above."),r.a.createElement(ze.GithubPicker,{width:"100%",color:this.state.color,triangle:"hide",onChangeComplete:this.handleColorPickerChangeComplete,colors:Zt})))),r.a.createElement(M.a,{variant:"primary",onClick:this.handleSave},"Save")))}}]),t}(n.Component),oa=function(e){function t(e,a){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e,a))).handleClose=function(){n.setState({show:!1})},n.handleShow=function(){n.setState({show:!0})},n.state={show:!1,color:n.props.color,label:n.props.label,description:n.props.description,labelId:n.props.labelId},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(M.a,{variant:"link",size:"sm",onClick:this.handleShow,block:!0},this.props.openBtn),r.a.createElement(z.a,{show:this.state.show,onHide:this.handleClose},r.a.createElement(z.a.Header,{closeButton:!0},r.a.createElement(z.a.Title,null,r.a.createElement(I.a,{icon:T.G}),"  Label ")),r.a.createElement(z.a.Body,null,r.a.createElement(sa,{onLabelSaved:this.props.onLabelSaved,label:this.props.label,description:this.props.description,color:this.props.color,labelId:this.props.labelId,handleClose:this.handleClose}))))}}]),t}(n.Component),la=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).removeLabel=function(e,t){!0===confirm("Click OK to delete the label, Cancel if you changed your mind")?a.props.onLabelDelete(e):alert("Your label was not deleted")},a.editLabel=function(e,t){var n=a.props.labelsOptions.filter(function(t){return t.id===e});console.log("labelToEdit",n)},a.onLabelSaved=function(e){e.id?a.props.onLabelUpdate(e):a.props.onLabelCreate(e)},a.showLabelModal=function(){console.log(a.state.isLabelmodalShown),a.setState(function(e){return{isLabelmodalShown:!e.isLabelmodalShown}})},a.state={isLabelmodalShown:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=this;this.props.labelsOptions&&(e=this.props.labelsOptions.map(function(e,a){return r.a.createElement(qe.a.Item,{style:{width:"100%"},key:"label_"+a},r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1,style:{backgroundColor:e.color},title:e.label}),r.a.createElement(x.a,{xs:6,sm:6,md:6,lg:6,xl:6,title:e.label},e.label),r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1},"default"!==e.label.toLowerCase()?r.a.createElement(oa,{color:e.color,label:e.label,description:e.description,labelId:e.id,show:t.state.isLabelmodalShown,onLabelSaved:t.onLabelSaved,openBtn:r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.w}))}):r.a.createElement(M.a,{title:"edit label",variant:"link",size:"sm",disabled:!0},r.a.createElement(I.a,{icon:T.w})," ")),r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1},r.a.createElement(M.a,{title:"delete label",variant:"link",size:"sm",onClick:function(a){t.removeLabel(e.id,a)},disabled:"default"===e.label.toLowerCase()},r.a.createElement(I.a,{icon:T.J})))),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1,className:"text-truncate",title:e.label}),r.a.createElement(x.a,{xs:10,sm:10,md:10,lg:10,xl:10},r.a.createElement(H.a.Text,{title:e.description},e.description))))}));var a=r.a.createElement(qe.a,{style:{height:"50vh",width:"20vw",overflowY:"scroll",overflowX:"hidden"}},e);return r.a.createElement(r.a.Fragment,null,this.props.isLabelsListOpen?r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,null,r.a.createElement(D.a.Header,null,r.a.createElement(I.a,{icon:T.H})," ",r.a.createElement(I.a,{icon:T.h})," Labels"),a,r.a.createElement(D.a.Footer,{className:"text-muted"},r.a.createElement(oa,{color:ra(),label:"",description:"",labelId:null,show:this.state.isLabelmodalShown,onLabelSaved:this.onLabelSaved,openBtn:r.a.createElement(M.a,{variant:"outline-secondary",block:!0},r.a.createElement(I.a,{icon:T.G})," Create New Label")})))):"")}}]),t}(n.Component);var ia=function(e){if(!window.getSelection().isCollapsed){var t=window.getSelection().getRangeAt(0).cloneContents().querySelectorAll(".words");if(0!==t.length)return{start:parseFloat(t[0].dataset.start),end:parseFloat(t[t.length-1].dataset.end)};var a=window.getSelection().anchorNode.parentElement;return"words"===a.className&&{start:parseFloat(a.dataset.start),end:parseFloat(a.dataset.end)}}return!1};function ca(e){var t=[],a=new Map,n=!0,r=!1,s=void 0;try{for(var o,l=e[Symbol.iterator]();!(n=(o=l.next()).done);n=!0){var i=o.value;a.has(i.speaker)||(a.set(i.speaker,!0),t.push({value:i.speaker,label:i.speaker}))}}catch(c){r=!0,s=c}finally{try{n||null==l.return||l.return()}finally{if(r)throw s}}return t}var da=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=function(){ue.getAllAnnotations(a.props.projectId,a.props.transcriptId).then(function(e){a.setState({annotations:e.annotations})})},a.onLabelCreate=function(e){ue.createLabel(a.props.projectId,e).then(function(e){a.setState({labelsOptions:e.labels})})},a.onLabelUpdate=function(e){console.log("updatedLabel",e),ue.updateLabel(a.props.projectId,e.id,e).then(function(e){a.setState({labelsOptions:e.labels})})},a.onLabelDelete=function(e){ue.deleteLabel(a.props.projectId,e).then(function(e){a.setState({labelsOptions:e.labels})})},a.handleTimecodeClick=function(e){if(e.target.classList.contains("timecode")){var t=e.target;a.videoRef.current.currentTime=t.dataset.start,a.videoRef.current.play()}},a.handleWordClick=function(e){if("words"===e.target.className){var t=e.target;a.videoRef.current.currentTime=t.dataset.start,a.videoRef.current.play()}},a.handleShowParagraphsMatchingSearch=function(){a.setState(function(e){return{showParagraphsMatchingSearch:!e.showParagraphsMatchingSearch}})},a.handleLabelsSearchChange=function(e){a.setState({selectedOptionLabelSearch:e})},a.handleSpeakersSearchChange=function(e){a.setState({selectedOptionSpeakerSearch:e})},a.handleSearch=function(e,t){if(""!==e.target.value){var n=e.target.value;a.setState({searchString:n.toLowerCase()}),Ge(a.highlightWords(n),500)}else""===e.target.value&&a.setState({sentenceToSearchCSS:"",searchString:""})},a.highlightWords=function(e){var t=e.toLowerCase().trim().split(" "),n='.paragraph[data-paragraph-text*="'.concat(t.join(" "),'"]'),r=t.map(function(e,a){var r="".concat(n,' > div > span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return a<t.length-1&&(r+=", "),r}),s=t.map(function(e,a){var r="".concat(n,' > div  > span >span.words[data-text="').concat(e.toLowerCase().trim(),'"]');return a<t.length-1&&(r+=", "),r});a.setState({sentenceToSearchCSS:r.join(" "),sentenceToSearchCSSInHighlights:s.join(" ")})},a.handleCreateAnnotation=function(e){var t=e.target,n=ia();if(n){var r=a.state.annotations;n.labelId=t.dataset.labelId,n.note="";var s=n;console.log("newAnnotation",s),ue.createAnnotation(a.props.projectId,a.props.transcriptId,s).then(function(e){var t=e.annotation;console.log("newAnnotationFromServer",t);var n=JSON.parse(JSON.stringify(r));n.push(t),a.setState({annotations:n})})}else alert("Select some text in the transcript to highlight ")},a.handleDeleteAnnotation=function(e){var t=a.state.annotations.filter(function(t){return t.id!==e}),n=JSON.parse(JSON.stringify(t));ue.deleteAnnotation(a.props.projectId,a.props.transcriptId,e).then(function(e){a.setState({annotations:n})})},a.handleEditAnnotation=function(e){var t=a.state.annotations,n=t.find(function(t){return t.id===e}),r=prompt("Edit the text note of the annotation",n.note);r?(n.note=r,ue.updateAnnotation(a.state.projectId,a.props.transcriptId,e,n).then(function(n){var r=n.annotation,s=t.filter(function(t){return t.id!==e});s.push(r),a.setState({annotations:s})})):alert("all good nothing changed")},a.showLabelsReference=function(){},a.getCurrentWordTime=function(){var e=a.props.transcript.words,t=a.state.currentTime,n=e.find(function(e){if(t>=e.start&&t<=e.end)return e.start});return void 0!==n?n[0]:0},a.videoRef=r.a.createRef(),a.state={searchString:"",showParagraphsMatchingSearch:!1,selectedOptionLabelSearch:!1,selectedOptionSpeakerSearch:[],sentenceToSearchCSS:"",sentenceToSearchCSSInHighlights:"",annotations:[],isLabelsListOpen:!0,labelsOptions:a.props.labelsOptions,currentTime:0},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.state.currentTime,a=Math.round(4*t)/4,n=r.a.createElement("style",{scoped:!0},'span.words[data-prev-times~="'.concat(Math.floor(a),'"][data-transcript-id="').concat(this.props.transcriptId,'"] { color: ').concat("grey"," }"));return r.a.createElement(r.a.Fragment,null,r.a.createElement("style",{scoped:!0},"".concat(this.state.sentenceToSearchCSS," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }"),"".concat(this.state.sentenceToSearchCSSInHighlights," { background-color: ","yellow","; text-shadow: 0 0 0.01px black }")),r.a.createElement("h2",{className:["text-truncate","text-muted"].join(" "),title:"Transcript Title: ".concat(this.props.title)},this.props.title),r.a.createElement("video",{src:this.props.url,ref:this.videoRef,onTimeUpdate:function(t){e.setState({currentTime:t.target.currentTime})},style:{width:"100%",height:"10em",backgroundColor:"black"},controls:!0}),r.a.createElement(D.a,null,r.a.createElement(D.a.Header,null,r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:12,sm:12,md:12,lg:12,xl:12},r.a.createElement(Ae.a,{style:{width:"100%"}},r.a.createElement(Fe.a,{as:Ae.a,style:{width:"100%"}},r.a.createElement(M.a,{variant:"outline-secondary","data-label-id":"default",onClick:this.handleCreateAnnotation},r.a.createElement(I.a,{icon:T.s,flip:"horizontal"})," Highlight"),r.a.createElement(Fe.a.Toggle,{split:!0,variant:"outline-secondary","data-lable-id":0}),r.a.createElement(Fe.a.Menu,{onClick:this.handleCreateAnnotation},this.state.labelsOptions&&this.state.labelsOptions.map(function(e){return r.a.createElement(Fe.a.Item,{key:"label_id_".concat(e.id),"data-label-id":e.id},r.a.createElement(y.a,{"data-label-id":e.id},r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1,style:{backgroundColor:e.color},"data-label-id":e.id}),r.a.createElement(x.a,{xs:1,sm:1,md:1,lg:1,xl:1,"data-label-id":e.id},e.label)))}))),r.a.createElement(Ot.a,{drop:"right",as:Ae.a,title:r.a.createElement(I.a,{icon:T.h}),id:"bg-nested-dropdown",variant:"outline-secondary"},r.a.createElement(la,{isLabelsListOpen:this.state.isLabelsListOpen,labelsOptions:this.state.labelsOptions&&this.state.labelsOptions,onLabelUpdate:this.onLabelUpdate,onLabelCreate:this.onLabelCreate,onLabelDelete:this.onLabelDelete})))))),r.a.createElement(Wt,{labelsOptions:this.state.labelsOptions,speakersOptions:this.props.transcript?ca(this.props.transcript.paragraphs):null,handleSearch:this.handleSearch,handleLabelsSearchChange:this.handleLabelsSearchChange,handleSpeakersSearchChange:this.handleSpeakersSearchChange,handleShowParagraphsMatchingSearch:this.handleShowParagraphsMatchingSearch}),r.a.createElement(D.a.Body,{onDoubleClick:this.handleWordClick,onClick:this.handleTimecodeClick,style:{height:"60vh",overflow:"scroll"}},r.a.createElement("div",null,n,this.props.transcript&&r.a.createElement($t,{labelsOptions:this.state.labelsOptions&&this.state.labelsOptions,annotations:this.state.annotations?this.state.annotations:[],transcriptJson:this.props.transcript,searchString:this.state.searchString?this.state.searchString:"",showParagraphsMatchingSearch:this.state.showParagraphsMatchingSearch,selectedOptionLabelSearch:this.state.selectedOptionLabelSearch?this.state.selectedOptionLabelSearch:[],selectedOptionSpeakerSearch:this.state.selectedOptionSpeakerSearch?this.state.selectedOptionSpeakerSearch:[],transcriptId:this.props.transcriptId,handleTimecodeClick:this.handleTimecodeClick,handleWordClick:this.handleWordClick,handleDeleteAnnotation:this.handleDeleteAnnotation,handleEditAnnotation:this.handleEditAnnotation})))))}}]),t}(n.Component),pa=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this,t=this.props.transcripts.map(function(e,t){return r.a.createElement(Bt.a.Item,{key:e.id},r.a.createElement(Bt.a.Link,{disabled:"done"!==e.status,eventKey:e.id},"in-progress"===e.status?r.a.createElement(I.a,{icon:T.g}):"","error"===e.status?r.a.createElement(I.a,{icon:T.j}):"","  ".concat(e.transcriptTitle)))}),a=this.props.transcripts.map(function(t,a){return r.a.createElement(Ee.a.Pane,{key:t.id,eventKey:t.id},r.a.createElement(da,{projectId:e.props.projectId,transcriptId:t.id,labelsOptions:e.props.labelsOptions,title:t.transcriptTitle,transcript:t.transcript,url:t.url}))});return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ee.a.Container,{defaultActiveKey:this.props.transcripts[0]?this.props.transcripts[0].id:"first"},r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:3},r.a.createElement("h2",{className:["text-truncate","text-muted"].join(" "),title:"Transcripts"},"Transcripts"),r.a.createElement("hr",null),r.a.createElement(Bt.a,{variant:"pills",className:"flex-column"},t)),r.a.createElement(x.a,{sm:9},r.a.createElement(Ee.a.Content,null,a)))))}}]),t}(n.Component),ha=a(111),ua=a.n(ha),ma=a(235),fa=a.n(ma),ba=function(e){function t(e){var a;Object(l.a)(this,t);var n=e.width,s=void 0===n?640:n,o=e.height,i=void 0===o?360:o,p=e.playlist,h=void 0===p?[]:p;return(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).loadPlaylist=function(){a.playlist.forEach(function(e){var t=e.type,n=e.sourceStart,r=e.start,s=e.duration,o=e.src,l=a.videoContext[t](o,n);l.startAt(r),l.stopAt(r+s),l.connect(a.videoContext.destination)})},a.playlist=h,a.canvasRef=r.a.createRef(),a.canvas=r.a.createElement("canvas",{ref:a.canvasRef,width:s,height:i}),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.videoContext=new fa.a(this.canvasRef.current,function(e){return console.error("There was problem instantiating the Video Context in Paper Cuts Player Viewer component",e)}),this.loadPlaylist()}},{key:"render",value:function(){return this.canvas}}]),t}(r.a.PureComponent),ga=a(53),Ea=a.n(ga),va=function(e){function t(e){var a;Object(l.a)(this,t);var n=e.width,s=void 0===n?640:n;return(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).updateProgress=function(){return requestAnimationFrame(function(){var e=(a.videoContext&&a.videoContext.currentTime)/a.state.duration*100;a.state.progress!==e&&a.setState({progress:e}),requestAnimationFrame(a.updateProgress)})},a.handleClick=function(e){var t=e.nativeEvent.offsetX;a.videoContext.currentTime=t/a.width*a.state.duration},a.getTracks=function(){return a.state.duration&&a.videoContext._sourceNodes.reverse().map(function(e,t){var n=e.startTime,s=e.stopTime,o=e.elementURL,l=n/a.state.duration*a.width,i=(s-n)/a.state.duration*a.width,c="".concat(o.split("/").slice(-1).pop(),".").concat(t);return r.a.createElement("div",{key:c,style:{pointerEvents:"none"}},r.a.createElement("div",{className:Ea.a.papercutsPlayerProgressTrackBuffer}),r.a.createElement("div",{className:Ea.a.papercutsPlayerProgressTrack,style:{width:i,marginLeft:l}}),r.a.createElement("div",{className:Ea.a.papercutsPlayerProgressTrackBuffer}))})},a.width=s,a.state={progress:0},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){this.videoContext=this.props.videoContext,this.setState({duration:this.videoContext.duration}),this.updateProgress()}},{key:"render",value:function(){return this.tracks||(this.tracks=this.getTracks()),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:[Ea.a.papercutsPlayerProgress,Ea.a.papercutsPlayerProgressBack].join(" "),onClick:this.handleClick,style:{width:this.width}},r.a.createElement("div",{className:[Ea.a.papercutsPlayerProgress,Ea.a.papercutsPlayerProgressFront].join(" "),style:{width:"".concat(this.state.progress,"%")}},this.tracks)))}}]),t}(r.a.PureComponent),Sa=r.a.createElement(I.a,{icon:T.x}),wa=r.a.createElement(I.a,{icon:T.v}),ka=r.a.createElement(I.a,{icon:T.D}),ya=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).handlePlay=function(){a.props.videoContext.play(),a.setState({isPlaying:!0})},a.handlePause=function(){a.props.videoContext.pause(),a.setState({isPlaying:!1})},a.handleStop=function(){a.props.videoContext.pause(),a.props.videoContext.currentTime=0,a.setState({isPlaying:!1})},a.state={isPlaying:!1},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(x.a,{sm:6,md:6,ld:6,xl:6},r.a.createElement(M.a,{size:"sm",block:!0,variant:"outline-secondary",onClick:this.state.isPlaying?this.handlePause:this.handlePlay},this.state.isPlaying?wa:Sa)),r.a.createElement(x.a,{sm:6,md:6,ld:6,xl:6},r.a.createElement(M.a,{size:"sm",block:!0,variant:"outline-secondary",onClick:this.handleStop},ka)))}}]),t}(r.a.PureComponent),ja=function(e){function t(e){var a;Object(l.a)(this,t);var n=e.playlist,s=void 0===n?[]:n,o=e.width,i=void 0===o?640:o;return(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).width=i,a.height=9/16*a.width,a.playlist=s,a.videoContextRef=r.a.createRef(),a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.videoContext=this.videoContextRef&&this.videoContextRef.current&&this.videoContextRef.current.videoContext,this.forceUpdate()}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,{className:"justify-content-center",style:{backgroundColor:"black"}},r.a.createElement(ba,{ref:this.videoContextRef,playlist:this.playlist,width:this.width,height:this.height})),r.a.createElement(y.a,{className:"justify-content-center",style:{backgroundColor:"lightgrey"}},r.a.createElement(va,{width:this.width,videoContext:this.videoContext&&this.videoContext})),r.a.createElement(y.a,{style:{marginTop:"0.4em"}},r.a.createElement(ya,{videoContext:this.videoContext&&this.videoContext})))}}]),t}(r.a.PureComponent),xa=a(236),Oa=a.n(xa),Ca=a(237),Pa=a.n(Ca),Ia=a(238),Ta=a.n(Ia),La=a(69),Na=a.n(La),Da=a(107),Aa=a.n(Da),Ma=a(112),Fa=a(239),Ua=a.n(Fa),Ba=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("p",{className:"text-muted"},r.a.createElement(I.a,{icon:T.u})," ",this.props.text))}}]),t}(n.Component),Ra=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e;return this.props.words&&(e=this.props.words.map(function(e,t){return r.a.createElement("span",{key:e.start+t,className:"words",title:"stat: ".concat(e.start,"- end: ").concat(e.end),"data-start":e.start,"data-end":e.end},e.text," ")})),r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:3,className:"text-truncate text-muted",title:"".concat(this.props.speaker.toUpperCase()),style:{userSelect:"none"}},r.a.createElement("strong",null,this.props.speaker.toUpperCase())),r.a.createElement(x.a,{sm:9},e)))}}]),t}(n.Component),_a=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("h4",null,this.props.title)}}]),t}(n.Component),Wa=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("p",{className:"text-secondary"},r.a.createElement(I.a,{icon:T.C})," ",this.props.text)}}]),t}(n.Component),Ja=function(e){var t=e.text;return r.a.createElement("span",{style:{width:"100%",backgroundColor:"orange",color:"white"}}," ",r.a.createElement(I.a,{icon:T.e})," ",t," ")},Ga=Object(Ma.sortableHandle)(function(){return r.a.createElement("span",null," ",r.a.createElement(I.a,{icon:T.q})," ")}),Va=Object(Ma.sortableElement)(function(e){var t=e.value,a=e.index,n=e.type,s=e.handleDelete,o=e.handleEdit;return r.a.createElement("li",null,r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:1,sm:1,md:1,ld:1,xl:1,style:{backgroundColor:"insert-point"===n?"orange":""}},r.a.createElement(Ga,null)),r.a.createElement(x.a,{xs:8,sm:9,md:9,ld:9,xl:9,style:{backgroundColor:"insert-point"===n?"orange":""}},t),r.a.createElement(x.a,{xs:1,sm:1,md:1,ld:1,xl:1,style:{backgroundColor:"insert-point"===n?"orange":""}},"paper-cut"!==n&&"insert-point"!==n?r.a.createElement(I.a,{className:"text-muted",icon:T.w,onClick:function(){o(a)}}):null),r.a.createElement(x.a,{xs:1,sm:1,md:1,ld:1,xl:1,style:{backgroundColor:"insert-point"===n?"orange":""}},"insert-point"!==n?r.a.createElement(I.a,{className:"text-muted",icon:T.K,onClick:function(){s(a)}}):null,"insert-point"===n?r.a.createElement(I.a,{style:{color:"white"},icon:T.d}):null)))}),qa=Object(Ma.sortableContainer)(function(e){var t=e.children;return r.a.createElement("ul",{style:{listStyle:"none",padding:"0px"}},t)}),za=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).onSortEnd=function(e){var t=e.oldIndex,n=e.newIndex,r=Ua()(a.props.programmeScriptElements,t,n);console.log(r),a.props.handleProgrammeScriptOrderChange(r)},a.state={},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t,a=this;return this.props.programmeScriptElements&&(e=this.props.programmeScriptElements.map(function(e){switch(e.type){case"title":return{el:r.a.createElement(_a,{key:e.id,title:e.text}),type:e.type};case"voice-over":return{el:r.a.createElement(Ba,{key:e.id,text:e.text}),type:e.type};case"paper-cut":return{el:r.a.createElement(Ra,{key:e.id,el:e,speaker:e.speaker,words:e.words}),type:e.type};case"note":return{el:r.a.createElement(Wa,{key:e.id,text:e.text}),type:e.type};case"insert-point":return{el:r.a.createElement(Ja,{text:e.text}),type:e.type};default:return console.error("invalid programme element type"),null}})),this.props.programmeScriptElements&&(t=r.a.createElement(qa,{useDragHandle:!0,onSortEnd:this.onSortEnd},e.map(function(e,t){return r.a.createElement(Va,{key:"item-".concat(t),index:t,value:e.el,type:e.type,handleDelete:a.props.handleDeleteProgrammeScriptElement,handleEdit:a.props.handleEditProgrammeScriptElement})}))),r.a.createElement(r.a.Fragment,null,t)}}]),t}(n.Component);var Ka=function(e){if(!window.getSelection().isCollapsed){var t=window.getSelection().getRangeAt(0).cloneContents().querySelectorAll(".words");if(0!==t.length)return window.words=t,{start:parseFloat(t[0].dataset.start),end:parseFloat(t[t.length-1].dataset.end),transcriptId:t[0].dataset.transcriptId,speaker:t[0].dataset.speaker,words:Array.from(t).map(function(e){return{start:(t=e).dataset.start,end:t.dataset.end,text:t.innerText,speaker:t.dataset.speaker,transcriptId:t.dataset.transcriptId};var t})};var a=window.getSelection().anchorNode.parentElement;return"words"===a.className&&{start:parseFloat(a.dataset.start),end:parseFloat(a.dataset.end),transcriptId:t[0].dataset.transcriptId,speaker:t[0].dataset.speaker,words:t}}return!1},Ha=function(e){var t=e[0];return 0===e.filter(function(e){return e.speaker!==t.speaker}).length},Xa=function(e){if(Ha(e))return e;var t=e[0].speaker,a=[],n=[];return e.forEach(function(r,s){r.speaker===t?a.push(r):(n.push(a),(a=[]).push(r),t=r.speaker),s===e.length-1&&n.push(a)}),n},Ya=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=function(){ue.getPaperEdit(a.props.projectId,a.props.papereditId).then(function(e){var t=e.programmeScript;t.elements.push({type:"insert-point",text:"Insert Point to add selection"}),a.setState({programmeScript:t})})},a.handleProgrammeScriptOrderChange=function(e){console.log("handleProgrammeScriptOrderChange",e),a.setState(function(t){var a=t.programmeScript;return a.elements=e,{programmeScript:a}})},a.handleDeleteProgrammeScriptElement=function(e){console.log(e),a.setState(function(t){var a=t.programmeScript,n=e,r=a.elements;return r.splice(n,1),a.elements=r,{programmeScript:a}})},a.handleEditProgrammeScriptElement=function(e){console.log(e);var t=a.state.programmeScript,n=t.elements,r=n[e],s=prompt("Edit",r.text);console.log(s),s&&(r.text=s,n[e]=r,t.elements=n,a.setState({programmeScript:t}))},a.handleAddTranscriptElementToProgrammeScript=function(e){var t=a.state.programmeScript,n=a.state.programmeScript.elements;if("title"===e||"note"===e||"voice-over"===e){var r=prompt("Add some text for a section title","Some place holder text");console.log(r);var s=a.getIndexPositionOfInsertPoint(),o={id:ua()(),index:n.length,type:e,text:r};n.splice(s,0,o),t.elements=n,a.setState({programmeScript:t})}},a.getIndexPositionOfInsertPoint=function(){var e=a.state.programmeScript.elements,t=e.find(function(e){return"insert-point"===e.type});return e.indexOf(t)},a.handleAddTranscriptSelectionToProgrammeScript=function(){var e=Ka();if(console.log("getDataFromUserWordsSelection::",e),e){console.log(JSON.stringify(e,null,2));var t=a.state.programmeScript,n=t.elements,r=a.getIndexPositionOfInsertPoint();if(Ha(e.words)){var s={id:ua()(),index:n.length,type:"paper-cut",start:e.start,end:e.end,speaker:e.speaker,words:e.words,transcriptId:e.transcriptId,labelId:[]};n.splice(r,0,s),t.elements=n}else{Xa(e.words).reverse().forEach(function(e){var a={id:ua()(),index:n.length,type:"paper-cut",start:e[0].start,end:e[e.length-1].end,speaker:e[0].speaker,words:e,transcriptId:e[0].transcriptId,labelId:[]};n.splice(r,0,a),t.elements=n})}a.setState({programmeScript:t})}else alert("Select some text in the transcript to add to the programme script"),console.log("nothing selected")},a.getSequenceJsonEDL=function(){var e,t={title:a.state.programmeScript.title,events:[]},n=a.state.programmeScript.elements.map(function(e){if("paper-cut"===e.type){var t=a.props.transcripts.find(function(t){return t.id===e.transcriptId});return{startTime:e.start,endTime:e.end,reelName:"NA",clipName:"".concat(t.clipName),fps:24,offset:0}}return null}).filter(function(e){return null!==e}).map(function(e,t){return e.id=t+1,e});return(e=t.events).push.apply(e,Object(E.a)(n)),t},a.handleExportEDL=function(){var e=a.getSequenceJsonEDL(),t=new Oa.a(e);console.log(t.compose()),Na()(t.compose(),"".concat(a.state.programmeScript.title,".edl"),"text/plain")},a.handleExportADL=function(){var e=a.getSequenceJsonEDL(),t=Pa()({projectOriginator:"Digital Paper Edit",edits:e.events.map(function(e){return{start:e.startTime,end:e.endTime,clipName:e.clipName,label:""}}),sampleRate:"44100",frameRate:24,projectName:e.title});Na()(t,"".concat(a.state.programmeScript.title,".adl"),"text/plain")},a.handleExportFCPX=function(){var e=a.getSequenceJsonEDL();console.log(e);var t=Ta()(e);Na()(t,"".concat(a.state.programmeScript.title,".fcpxml"),"text/plain")},a.getProgrammeScriptJson=function(){var e,t={title:a.state.programmeScript.title,events:[]},n=a.state.programmeScript.elements.map(function(e){if("paper-cut"===e.type){console.log("paper-cut::",e);var t=a.props.transcripts.find(function(t){return t.id===e.transcriptId});return Object(ht.a)({},e,{startTime:e.start,endTime:e.end,reelName:"NA",clipName:"".concat(t.clipName),fps:24,offset:0})}return e}).filter(function(e){return null!==e}).map(function(e,t){return e.id=t+1,e});return(e=t.events).push.apply(e,Object(E.a)(n)),console.log(t),t},a.programmeScriptJsonToText=function(e){var t="# ".concat(e.title,"\n\n"),a=e.events.map(function(e){return"title"===e.type?"## ".concat(e.text):"voice-over"===e.type?"_".concat(e.text,"_"):"note"===e.type?"[ ".concat(e.text,"]"):"paper-cut"===e.type?"".concat(Aa.a.fromSeconds(e.startTime),"\t").concat(Aa.a.fromSeconds(e.endTime),"\t").concat(e.speaker,"\t-\t").concat(e.clipName,"     \n").concat(e.words.map(function(e){return e.text}).join(" ")):null});return"".concat(t).concat(a.join("\n\n"))},a.handleExportJson=function(){var e=a.getProgrammeScriptJson(),t=JSON.stringify(e,null,2);Na()(t,"".concat(a.state.programmeScript.title,".json"),"text/plain")},a.handleExportTxt=function(){var e=a.getProgrammeScriptJson(),t=a.programmeScriptJsonToText(e);Na()(t,"".concat(a.state.programmeScript.title,".txt"),"text/plain")},a.handleUpdatePreview=function(){var e=0,t=a.state.programmeScript.elements.map(function(t){if("paper-cut"===t.type){var n=a.props.transcripts.find(function(e){return e.id===t.transcriptId}),r=t.end-t.start,s={type:"video",start:e,sourceStart:t.start,duration:r,src:n.url};return e+=r,s}return null}).filter(function(e){return null!==e});a.setState({resetPreview:!0},function(){console.log("handleUpdatePreview",t),a.setState({resetPreview:!1,playlist:t})}),console.log("handleUpdatePreview",t),a.setState({playlist:t})},a.handleDoubleClickOnProgrammeScript=function(e){if("words"===e.target.className){var t=e.target.dataset.start;console.log("wordCurrentTime::",t)}},a.handleSaveProgrammeScript=function(){var e=a.state.programmeScript;if(e){var t=e.elements,n=t.find(function(e){return"insert-point"===e.type});if(n){var r=t.indexOf(n);t.splice(r,1)}e.elements=t,ue.updatePaperEdit(a.props.projectId,a.props.papereditId,e).then(function(e){"ok"===e.status&&alert("saved programme script")})}},a.state={programmeScript:null,resetPreview:!1,playlist:[]},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(Ee.a.Content,null,r.a.createElement("h2",{className:["text-truncate","text-muted"].join(" "),title:"Programme Script Title: ".concat(this.state.programmeScript?this.state.programmeScript.title:"")},this.state.programmeScript?this.state.programmeScript.title:""),this.state.resetPreview?null:r.a.createElement(ja,{playlist:this.state.playlist,width:"300"}),r.a.createElement("br",null),r.a.createElement(y.a,{noGutters:!0},r.a.createElement(x.a,{sm:12,md:3,ld:3,xl:3},r.a.createElement(M.a,{variant:"outline-secondary",onClick:this.handleAddTranscriptSelectionToProgrammeScript,title:"Add a text selection, select text in the transcript, then click this button to add it to the programme script"},r.a.createElement(I.a,{icon:T.y})," Selection")),r.a.createElement(x.a,{sm:12,md:2,ld:2,xl:2},r.a.createElement(Fe.a,null,r.a.createElement(Fe.a.Toggle,{variant:"outline-secondary"},r.a.createElement(I.a,{icon:T.y})),r.a.createElement(Fe.a.Menu,null,r.a.createElement(Fe.a.Item,{onClick:function(){e.handleAddTranscriptElementToProgrammeScript("title")},title:"Add a title header element to the programme script"},r.a.createElement(I.a,{icon:T.r})," Heading"),r.a.createElement(Fe.a.Item,{onClick:function(){e.handleAddTranscriptElementToProgrammeScript("voice-over")},title:"Add a title voice over element to the programme script"},r.a.createElement(I.a,{icon:T.u})," Voice Over"),r.a.createElement(Fe.a.Item,{onClick:function(){e.handleAddTranscriptElementToProgrammeScript("note")},title:"Add a note element to the programme script"},r.a.createElement(I.a,{icon:T.C})," Note")))),r.a.createElement(x.a,{sm:12,md:3,ld:3,xl:3},r.a.createElement(M.a,{variant:"outline-secondary",onClick:this.handleUpdatePreview,title:"update preview"},r.a.createElement(I.a,{icon:T.E})," Preview")),r.a.createElement(x.a,{sm:12,md:3,ld:3,xl:3},r.a.createElement(Fe.a,null,r.a.createElement(Fe.a.Toggle,{variant:"outline-secondary"},r.a.createElement(I.a,{icon:T.B})," Export"),r.a.createElement(Fe.a.Menu,null,r.a.createElement(Fe.a.Item,{onClick:this.handleExportEDL,title:"export EDL, edit decision list, to import the programme script as a sequence in video editing software - Avid, Premiere, Davinci Resolve, for FCPX choose FCPX XML"},"EDL - Video ",r.a.createElement(I.a,{icon:T.t})),r.a.createElement(Fe.a.Item,{onClick:this.handleExportADL,title:"export ADL, audio decision list, to import the programme script as a sequence in audio editing software such as SADiE"},"ADL - Audio  ",r.a.createElement(I.a,{icon:T.t})),r.a.createElement(Fe.a.Item,{onClick:this.handleExportFCPX,title:"export FCPX XML, to import the programme script as a sequence in Final Cut Pro X, video editing software"},"FCPX ",r.a.createElement(I.a,{icon:T.t})),r.a.createElement(Fe.a.Divider,null),r.a.createElement(Fe.a.Item,{onClick:this.handleExportTxt,title:"export Text, export the programme script as a text version"},"Text File ",r.a.createElement(I.a,{icon:T.t})),r.a.createElement(Fe.a.Item,{onClick:function(){alert("export word doc not implemented yet")},title:"export docx, export the programme script as a word document"},"Word Document ",r.a.createElement(I.a,{icon:T.t})),r.a.createElement(Fe.a.Divider,null),r.a.createElement(Fe.a.Item,{onClick:this.handleExportJson,title:"export Json, export the programme script as a json file"},"Json ",r.a.createElement(I.a,{icon:T.t}))))),r.a.createElement(x.a,{sm:12,md:1,ld:1,xl:1},r.a.createElement(M.a,{variant:"outline-secondary",onClick:this.handleSaveProgrammeScript,title:"save programme script",block:!0},r.a.createElement(I.a,{icon:T.z})))),r.a.createElement("hr",null),r.a.createElement("article",{style:{height:"60vh",overflow:"scroll"},onDoubleClick:this.handleDoubleClickOnProgrammeScript},this.state.programmeScript?r.a.createElement(za,{programmeScriptElements:this.state.programmeScript.elements,handleProgrammeScriptOrderChange:this.handleProgrammeScriptOrderChange,handleDeleteProgrammeScriptElement:this.handleDeleteProgrammeScriptElement,handleEditProgrammeScriptElement:this.handleEditProgrammeScriptElement}):null))}}]),t}(n.Component),$a=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=Object(g.a)(b.a.mark(function e(){return b.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ue.get_ProgrammeScriptAndTranscripts(a.state.projectId,a.state.papereditId).then(function(e){a.setState({programmeTitle:e.programmeScript.title,projectTitle:e.project.title,transcripts:e.transcripts,labelsOptions:e.labels})});case 1:case"end":return e.stop()}},e)})),a.toggleTranscripts=function(){a.state.isProgramScriptShown&&a.setState(function(e){return{isTranscriptsShown:!e.isTranscriptsShown}})},a.toggleProgramScript=function(){a.state.isTranscriptsShown&&a.setState(function(e){return{isProgramScriptShown:!e.isProgramScriptShown}})},a.state={projectId:a.props.match.params.projectId,papereditId:a.props.match.params.papereditId,projectTitle:"",programmeTitle:"",transcripts:[],labelsOptions:[],isTranscriptsShown:!0,isProgramScriptShown:!0},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(w.a,{style:{marginBottom:"5em"},fluid:!0},r.a.createElement(L,{links:Lt(this.state.projectId)}),r.a.createElement("br",null),r.a.createElement(y.a,null,r.a.createElement(x.a,{sm:12,md:12,ld:12,xl:12},r.a.createElement(Z,{items:[{name:"Projects",link:"/projects"},{name:"Project: ".concat(this.state.projectTitle),link:"/projects/".concat(this.state.projectId)},{name:"PaperEdits"},{name:"".concat(this.state.programmeTitle)}]}))),r.a.createElement(w.a,{fluid:!0},r.a.createElement("div",{className:"d-flex flex-column"},r.a.createElement(Ae.a,{size:"sm",className:"mt-12"},r.a.createElement(M.a,{onClick:this.toggleTranscripts,variant:this.state.isTranscriptsShown?"secondary":"outline-secondary"},"Transcripts ",r.a.createElement(I.a,{icon:this.state.isTranscriptsShown?T.b:T.c})," ",this.state.isTranscriptsShown?"hide":"show"),r.a.createElement(M.a,{onClick:this.toggleProgramScript,variant:this.state.isProgramScriptShown?"secondary":"outline-secondary"},"Program Script  ",r.a.createElement(I.a,{icon:this.state.isProgramScriptShown?T.b:T.c}),"  ",this.state.isProgramScriptShown?"hide":"show"))),r.a.createElement(y.a,null,r.a.createElement(x.a,{xs:{span:12,offset:0},sm:{span:this.state.isProgramScriptShown?7:12,offset:(this.state.isProgramScriptShown,0)},md:{span:this.state.isProgramScriptShown?7:12,offset:(this.state.isProgramScriptShown,0)},lg:{span:this.state.isProgramScriptShown?7:10,offset:this.state.isProgramScriptShown?0:1},xl:{span:this.state.isProgramScriptShown?7:10,offset:this.state.isProgramScriptShown?0:1},style:{display:this.state.isTranscriptsShown?"block":"none"}},this.state.transcripts.length?r.a.createElement(pa,{projectId:this.state.projectId,transcripts:this.state.transcripts,labelsOptions:this.state.labelsOptions}):r.a.createElement(r.a.Fragment,null,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("i",null,"No Transcripts, create a transcript to get started"))),r.a.createElement(x.a,{xs:{span:12,offset:0},sm:{span:this.state.isTranscriptsShown?5:12,offset:(this.state.isTranscriptsShown,0)},md:{span:this.state.isTranscriptsShown?5:12,offset:(this.state.isTranscriptsShown,0)},lg:{span:this.state.isTranscriptsShown?5:10,offset:this.state.isTranscriptsShown?0:1},xl:{span:this.state.isTranscriptsShown?5:8,offset:this.state.isTranscriptsShown?0:2},style:{display:this.state.isProgramScriptShown?"block":"none"}},r.a.createElement(Ya,{projectId:this.state.projectId,papereditId:this.state.papereditId,transcripts:this.state.transcripts})))),r.a.createElement(ae,null))}}]),t}(n.Component),Qa=(a(488),r.a.createElement("p",null," This is Demo version of the app ",r.a.createElement(ke.a.Link,{href:"https://github.com/bbc/digital-paper-edit-client",target:"_blank",rel:"noopener noreferrer"},"see project Github repository for more info"),"."),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={transcriptJson:null},a}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,null,r.a.createElement(h.a,null,r.a.createElement(u.a,null,r.a.createElement(m.a,{exact:!0,path:"/",component:me}),r.a.createElement(m.a,{exact:!0,path:"/projects",component:me}),r.a.createElement(m.a,{exact:!0,path:"/projects/:projectId",component:Ne}),r.a.createElement(m.a,{exact:!0,path:"/projects/:projectId/transcripts/:transcriptId/correct",component:Ft}),r.a.createElement(m.a,{exact:!0,path:"/projects/:projectId/transcripts/:transcriptId/annotate",component:At}),r.a.createElement(m.a,{exact:!0,path:"/projects/:projectId/paperedits/:papereditId",component:$a}))))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Qa,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},53:function(e,t,a){e.exports={papercutsPlayerProgress:"VideoContextProgressBar_papercutsPlayerProgress__3Ob4p",papercutsPlayerProgressBack:"VideoContextProgressBar_papercutsPlayerProgressBack__1Wjfn",papercutsPlayerProgressFront:"VideoContextProgressBar_papercutsPlayerProgressFront__3ggno",papercutsPlayerProgressTrack:"VideoContextProgressBar_papercutsPlayerProgressTrack__5E6Ba",papercutsPlayerProgressTrackBuffer:"VideoContextProgressBar_papercutsPlayerProgressTrackBuffer__1yKEJ"}}},[[241,1,2]]]);
//# sourceMappingURL=main.f1aa2883.chunk.js.map